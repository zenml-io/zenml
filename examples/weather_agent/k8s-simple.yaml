# Simple Kubernetes Deployment Configuration for Weather Agent
# 
# This is the MINIMAL configuration to get started with Kubernetes deployments.
# Perfect for local development, testing, or simple production deployments.
#
# What you get:
# ✅ Single replica deployment (no autoscaling)
# ✅ LoadBalancer service (automatic external IP)
# ✅ Health probes with sensible defaults
# ✅ 1 CPU, 2GB RAM
#
# To deploy:
#   zenml pipeline deploy weather_agent_pipeline -c k8s-simple.yaml

# Override default pipeline parameters
parameters:
  city: "London"

settings:
  # ========================================================================
  # Docker Image Settings
  # ========================================================================
  docker:
    parent_image: safoinme/zenml:deployer-0.4
    # For local testing: include code in image instead of downloading
    allow_download_from_artifact_store: false
    allow_including_files_in_images: true
  
  # ========================================================================
  # Resource Configuration
  # ========================================================================
  resources:
    cpu_count: 1        # 1 CPU core
    memory: "2GB"       # 2 GB RAM
    min_replicas: 1     # Single replica (no autoscaling)
    max_replicas: 1
  
  # ========================================================================
  # Kubernetes Deployer Settings
  # ========================================================================
  deployer:
    # Namespace - creates if doesn't exist
    namespace: weather-demo
    
    # Service type - LoadBalancer provides external IP automatically
    # For local k3d/kind, use NodePort instead
    service_type: LoadBalancer
    service_port: 8000
    
    # Health probes - ensures deployment is healthy before routing traffic
    # Defaults are good for most use cases
    readiness_probe_path: /api/health
    liveness_probe_path: /api/health
    
    # Manifest saving - useful for debugging
    save_manifests: true  # Saves to .zenml-deployments/
    
    # Wait up to 5 minutes for deployment to be ready
    # Set to 0 to skip waiting (deploy and exit)
    # deployment_ready_timeout: 300