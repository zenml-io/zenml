<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ZenML Deployment Playground</title>
  <style>
    :root {
      /* Surface Colors */
      --surface-primary: #ffffff;
      --surface-secondary: #f9fafb;
      --surface-strong: #7a3ef4;

      /* Border Colors */
      --border-moderate: #e5e7eb;
      --border-hover: #d1d5db;
      --border-bold: #6b7280;

      /* Text Colors */
      --text-primary: #0d061d;
      --text-secondary: #6b7280;
      --text-tertiary: #9ca3af;
      --text-brand: #7a3ef4;
      --text-error: #eb483d;

      /* Button Colors */
      --button-border-secondary-enabled: #d1d5db;
      --button-text-over-secondary-enabled: #0d061d;
      --button-background-primary-bold-enabled: #431d93;
      --button-background-primary-bold-disabled: #e4d8fd;
      --button-text-over-primary-bold: #ffffff;
      --button-text-over-primary-subtle: #361776;
      --button-border-primary-disabled: #cab2fb;
      --button-border-warning-enabled: #c43c33;
      --button-text-over-warning-subtle: #9d3029;

      /* Color Palette */
      --color-primary-25: #f1ebfe;
      --color-primary-50: #e4d8fd;
      --color-primary-400: #7a3ef4;
      --color-primary-500: #431d93;
      --color-success-50: #d2f2db;
      --color-success-200: #8ddfa4;
      --color-success-800: #0e6025;

      /* Spacing */
      --spacing-0: 0px;
      --spacing-025: 2px;
      --spacing-05: 4px;
      --spacing-1: 8px;
      --spacing-2: 12px;
      --spacing-3: 16px;
      --spacing-4: 20px;
      --spacing-5: 24px;
      --spacing-6: 32px;
      --spacing-7: 40px;
      --spacing-8: 48px;
      --spacing-9: 64px;
      --spacing-10: 85px;
      --spacing-11: 80px;
      --spacing-12: 88px;

      /* Border Radius */
      --radius-sm: 4px;
      --radius-md: 8px;
      --radius-circle: 999px;

      /* Font */
      --font-family-default: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      --font-family-mono: 'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, Monaco, monospace;
      --font-weight-medium: 500;
      --font-weight-semibold: 600;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html,
    body {
      height: 100%;
      font-family: var(--font-family-default);
      background: var(--surface-primary);
      color: var(--text-primary);
      line-height: 1.5;
    }

    body {
      display: grid;
      grid-template-rows: auto auto 1fr;
      min-height: 100vh;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    button {
      font-family: inherit;
      border: none;
      background: transparent;
      cursor: pointer;
      transition: all 0.15s ease;
    }

    button:disabled {
      cursor: not-allowed;
      opacity: 0.6;
    }

    .hidden {
      display: none !important;
    }

    /* Grid Layout System */
    :root {
      --content-max-width: 1690px;
      --side-margin: var(--spacing-11);
    }

    .grid-container {
      display: grid;
      grid-template-columns: var(--side-margin) 1fr var(--side-margin);
      width: 100%;
      max-width: var(--content-max-width);
      margin: 0 auto;
    }

    .grid-content {
      grid-column: 2;
    }

    .grid-full {
      grid-column: 1 / -1;
    }

    /* Top Navigation */
    .top-nav {
      height: var(--spacing-9);
      background: var(--surface-primary);
      border-bottom: 1px solid var(--border-moderate);
      display: flex;
      justify-content: center;
    }

    .top-nav-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: var(--spacing-3);
      max-width: var(--content-max-width);
      width: 100%;
      height: 100%;
    }

    .logo-container {
      flex: 0 0 var(--spacing-9);
      height: var(--spacing-9);
      border-right: 1px solid var(--border-moderate);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .logo {
      width: var(--spacing-6);
      height: var(--spacing-6);
    }

    .breadcrumbs {
      flex: 1;
      display: flex;
      align-items: center;
      gap: var(--spacing-1);
      padding-left: var(--spacing-3);
    }

    .breadcrumb-title {
      font-size: 16px;
      font-weight: var(--font-weight-semibold);
      color: var(--text-primary);
      line-height: 24px;
    }

    .top-nav-right {
      display: flex;
      align-items: center;
      gap: var(--spacing-1);
      flex-wrap: wrap;
    }

    .nav-button {
      background: var(--surface-primary);
      border: 1px solid var(--button-border-secondary-enabled);
      border-radius: var(--radius-md);
      height: 32px;
      padding: 0 var(--spacing-2);
      font-size: 14px;
      font-weight: var(--font-weight-semibold);
      color: var(--button-text-over-secondary-enabled);
      line-height: 20px;
      white-space: nowrap;
      flex-shrink: 0;
    }

    .nav-button:hover {
      border-color: var(--text-brand);
      color: var(--text-brand);
    }

    /* Deployment Header */
    .deployment-header {
      background: var(--surface-primary);
      border-bottom: 1px solid var(--border-moderate);
      height: var(--spacing-10);
      display: grid;
      grid-template-columns: var(--side-margin) 1fr var(--side-margin);
      align-items: center;
      max-width: var(--content-max-width);
      width: 100%;
      margin: 0 auto;
    }

    .deployment-header-content {
      grid-column: 2;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .deployment-header-left {
      display: flex;
      align-items: center;
      gap: var(--spacing-2);
    }

    .deployment-title {
      font-size: 24px;
      font-weight: var(--font-weight-semibold);
      line-height: 32px;
      color: var(--text-primary);
    }

    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: var(--spacing-1);
      background: var(--color-success-50);
      border: 1px solid var(--color-success-200);
      border-radius: var(--radius-md);
      height: 32px;
      padding: var(--spacing-1) var(--spacing-2);
      font-size: 14px;
      font-weight: var(--font-weight-medium);
      color: var(--color-success-800);
      line-height: 20px;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: currentColor;
    }

    .deployment-header-right {
      display: flex;
      gap: var(--spacing-2);
    }

    .share-button {
      background: var(--surface-primary);
      border: 1px solid var(--button-border-secondary-enabled);
      border-radius: var(--radius-md);
      height: 32px;
      padding: 0 var(--spacing-2);
      font-size: 14px;
      font-weight: var(--font-weight-semibold);
      color: var(--button-text-over-secondary-enabled);
      line-height: 20px;
      cursor: pointer;
    }

    .share-button:hover {
      border-color: var(--text-brand);
      color: var(--text-brand);
    }

    .more-button {
      background: transparent;
      border: 1px solid var(--button-border-secondary-enabled);
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: var(--radius-md);
      cursor: pointer;
    }

    .more-button:hover {
      border-color: var(--text-brand);
      color: var(--text-brand);
    }

    /* Main Layout */
    main {
      flex: 1;
      display: flex;
      justify-content: center;
      background: var(--surface-primary);
    }

    .main-layout {
      display: grid;
      grid-template-columns: 1fr 1fr;
      max-width: var(--content-max-width);
      width: 100%;
    }

    /* Panel Structure */
    .panel {
      display: flex;
      flex-direction: column;
      min-height: 0;
      background: var(--surface-primary);
    }

    .panel--left {
      border-right: 1px solid var(--border-moderate);
    }

    .panel--left .panel-header,
    .panel--left .panel-content {
      background: var(--surface-secondary);
    }

    .panel--right {
      background: var(--surface-primary);
    }

    .panel-header {
      height: var(--spacing-12);
      display: grid;
      grid-template-columns: var(--side-margin) 1fr var(--side-margin);
      align-items: center;
      flex-shrink: 0;
    }

    .panel-header-content {
      grid-column: 2;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: var(--spacing-3);
    }

    .panel-title {
      font-size: 18px;
      font-weight: var(--font-weight-semibold);
      line-height: 28px;
      color: var(--text-primary);
    }

    .toggle-group {
      display: flex;
      border: 1px solid var(--border-hover);
      border-radius: var(--radius-md);
      overflow: hidden;
      height: var(--spacing-7);
    }

    .toggle-button {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--spacing-05);
      padding: var(--spacing-1) var(--spacing-2);
      background: var(--surface-primary);
      border-right: 1px solid var(--border-hover);
      font-size: 16px;
      font-weight: var(--font-weight-semibold);
      line-height: 24px;
      color: var(--text-primary);
    }

    .toggle-button:last-child {
      border-right: none;
    }

    .toggle-button.active {
      background: var(--button-background-primary-bold-disabled);
      color: var(--button-text-over-primary-subtle);
    }

    .toggle-icon {
      width: 24px;
      height: 24px;
    }

    /* Panel Content */
    .panel-content {
      flex: 1;
      overflow-y: auto;
      padding: var(--spacing-5);
    }

    .panel-content--left,
    .panel-content--right {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-6);
      padding: var(--spacing-6) var(--side-margin);
    }

    .panel-content--left > *,
    .panel-content--right > * {
      width: 100%;
    }

    .panel-content--left > *:last-child,
    .panel-content--right > *:last-child {
      margin-bottom: 0;
    }

    /* JSON Editor */
    .json-editor {
      width: 100%;
      min-height: 400px;
      padding: var(--spacing-3);
      background: var(--surface-primary);
      border: 1px solid var(--border-moderate);
      border-radius: var(--radius-md);
      font-family: var(--font-family-mono);
      font-size: 14px;
      line-height: 20px;
      color: var(--text-primary);
      resize: vertical;
      outline: none;
      box-sizing: border-box;
    }

    .json-editor:focus {
      border-color: var(--text-brand);
    }

    /* Collapsible Sections */
    .collapsible {
      background: var(--surface-primary);
      border: 1px solid var(--border-moderate);
      border-radius: var(--radius-md);
      margin: 0 0 var(--spacing-3) 0;
      overflow: hidden;
      width: 100%;
    }

    .collapsible-header {
      display: flex;
      align-items: center;
      gap: var(--spacing-2);
      height: var(--spacing-8);
      padding: var(--spacing-3);
      border-bottom: 1px solid var(--border-moderate);
      cursor: pointer;
    }

    .chevron-icon {
      width: 16px;
      height: 16px;
      transition: transform 0.2s;
    }

    .collapsible.expanded .chevron-icon {
      transform: rotate(180deg);
    }

    .collapsible-title {
      flex: 1;
      font-size: 16px;
      font-weight: var(--font-weight-medium);
      line-height: 24px;
      color: var(--text-primary);
    }

    .collapse-button {
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--surface-primary);
      border: 1px solid var(--button-border-secondary-enabled);
      border-radius: var(--radius-md);
    }

    .collapse-icon {
      width: 24px;
      height: 24px;
    }

    .collapsible-content {
      padding: var(--spacing-5);
      display: none;
    }

    .collapsible.expanded .collapsible-content {
      display: block;
    }

    /* Form Container */
    #form-view {
      width: 100%;
      box-sizing: border-box;
    }

    /* Form Fields */
    .form-field {
      margin-bottom: var(--spacing-3);
      margin-left: 0;
      margin-right: 0;
      width: 100%;
      box-sizing: border-box;
    }

    .field-label {
      display: flex;
      align-items: center;
      gap: var(--spacing-1);
      margin: 0 0 var(--spacing-1) 0;
      padding: 0;
    }

    .field-icon {
      width: 24px;
      height: 24px;
    }

    .field-name {
      font-size: 14px;
      font-weight: var(--font-weight-medium);
      line-height: 20px;
      color: var(--text-primary);
    }

    .field-type {
      font-family: var(--font-family-mono);
      font-size: 12px;
      font-weight: var(--font-weight-medium);
      line-height: 18px;
      color: var(--text-secondary);
    }

    .field-required {
      font-size: 12px;
      line-height: 18px;
      color: var(--text-error);
    }

    .text-input {
      width: 100%;
      height: var(--spacing-8);
      padding: var(--spacing-3);
      background: var(--surface-primary);
      border: 1px solid var(--border-moderate);
      border-radius: var(--radius-md);
      font-family: var(--font-family-default);
      font-size: 18px;
      font-weight: var(--font-weight-medium);
      line-height: 28px;
      color: var(--text-secondary);
      outline: none;
      box-sizing: border-box;
    }

    .text-input:focus {
      border-color: var(--text-brand);
    }

    .text-input.filled {
      color: var(--text-primary);
    }

    .select-input {
      width: 180px;
      height: 48px;
      padding: var(--spacing-3);
      background: var(--surface-primary);
      border: 1px solid var(--border-moderate);
      border-radius: var(--radius-md);
      font-family: var(--font-family-default);
      font-size: 18px;
      font-weight: var(--font-weight-medium);
      line-height: 28px;
      color: var(--text-primary);
      outline: none;
      appearance: none;
      cursor: pointer;
    }

    /* Toggle Switch */
    .toggle-switch-container {
      display: flex;
      align-items: center;
      gap: var(--spacing-1);
      padding: var(--spacing-1) 0;
    }

    .toggle-switch {
      position: relative;
      width: 36px;
      height: 20px;
      background: var(--color-primary-400);
      border-radius: 12px;
      padding: 2px;
      cursor: pointer;
      transition: background 0.2s;
    }

    .toggle-switch.off {
      background: var(--border-bold);
    }

    .toggle-switch-button {
      width: 16px;
      height: 16px;
      background: white;
      border-radius: 50%;
      transition: transform 0.2s;
      transform: translateX(0);
    }

    .toggle-switch.on .toggle-switch-button {
      transform: translateX(16px);
    }

    .toggle-label {
      font-size: 14px;
      font-weight: var(--font-weight-medium);
      line-height: 20px;
      color: var(--text-primary);
    }

    /* Checkbox */
    .checkbox-container {
      display: flex;
      align-items: center;
      gap: var(--spacing-1);
      margin-bottom: var(--spacing-1);
    }

    .checkbox {
      width: 24px;
      height: 24px;
      border: 1px solid var(--border-bold);
      border-radius: var(--radius-sm);
      background: var(--surface-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .checkbox.checked {
      background: var(--surface-strong);
      border-color: var(--surface-strong);
    }

    .checkbox-label {
      font-size: 14px;
      font-weight: var(--font-weight-medium);
      line-height: 20px;
      color: var(--text-primary);
    }

    /* Panel Footer */
    .panel-footer {
      display: grid;
      grid-template-columns: var(--side-margin) 1fr var(--side-margin);
      align-items: center;
      border-top: 1px solid var(--border-moderate);
      padding: var(--spacing-5) 0;
      background: var(--surface-primary);
      flex-shrink: 0;
    }

    .panel-footer-content {
      grid-column: 2;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: var(--spacing-2);
    }

    .btn-secondary {
      height: var(--spacing-7);
      padding: 0 var(--spacing-3);
      background: var(--surface-primary);
      border: 1px solid var(--button-border-secondary-enabled);
      border-radius: var(--radius-md);
      font-size: 16px;
      font-weight: var(--font-weight-semibold);
      line-height: 24px;
      color: var(--button-text-over-secondary-enabled);
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .btn-secondary:hover {
      border-color: var(--text-brand);
      color: var(--text-brand);
    }

    .btn-primary {
      height: var(--spacing-7);
      padding: 0 var(--spacing-3);
      background: var(--button-background-primary-bold-enabled);
      border: 1px solid var(--button-background-primary-bold-enabled);
      border-radius: var(--radius-md);
      font-size: 16px;
      font-weight: var(--font-weight-semibold);
      line-height: 24px;
      color: var(--button-text-over-primary-bold);
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .btn-primary:hover {
      background: var(--color-primary-500);
      border-color: var(--color-primary-500);
    }

    .btn-primary:disabled {
      background: var(--button-background-primary-bold-disabled);
      border-color: var(--button-border-primary-disabled);
      cursor: not-allowed;
    }

    .btn-warning {
      height: var(--spacing-7);
      padding: 0 var(--spacing-3);
      background: transparent;
      border: 1px solid var(--button-border-warning-enabled);
      border-radius: var(--radius-md);
      font-size: 16px;
      font-weight: var(--font-weight-semibold);
      line-height: 24px;
      color: var(--button-text-over-warning-subtle);
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .btn-warning:hover {
      background: rgba(235, 72, 61, 0.05);
    }

    /* Run Card */
    .run-card {
      background: var(--surface-primary);
      border: 1px solid var(--border-moderate);
      border-radius: var(--radius-md);
      padding: var(--spacing-3);
      margin-bottom: var(--spacing-5);
      width: 100%;
      box-sizing: border-box;
    }

    .run-card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: var(--spacing-3);
      width: 100%;
      box-sizing: border-box;
    }

    .run-label {
      font-size: 12px;
      font-weight: var(--font-weight-medium);
      line-height: 18px;
      color: var(--text-tertiary);
      margin-bottom: var(--spacing-05);
    }

    .run-id {
      font-size: 16px;
      font-weight: var(--font-weight-semibold);
      line-height: 24px;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: var(--spacing-2);
      word-wrap: break-word;
      overflow-wrap: break-word;
      max-width: 100%;
    }

    .run-id-prefix {
      color: var(--text-tertiary);
    }

    .run-actions {
      display: flex;
      gap: var(--spacing-1);
    }

    .run-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 14px;
      line-height: 20px;
    }

    .run-user {
      display: flex;
      align-items: center;
      gap: var(--spacing-1);
      font-weight: var(--font-weight-medium);
      color: var(--text-primary);
    }

    .run-status {
      font-weight: var(--font-weight-medium);
      color: var(--text-secondary);
    }

    .run-status-completed {
      color: #1cbf4a;
    }

    /* Output Section */
    #preview-output,
    #json-output {
      width: 100%;
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    #preview-output > * {
      margin-left: 0;
      margin-right: 0;
    }

    .output-item {
      background: var(--surface-primary);
      border: 1px solid var(--border-moderate);
      border-radius: var(--radius-md);
      margin-bottom: var(--spacing-1);
      width: 100%;
      box-sizing: border-box;
    }

    .output-item-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 48px;
      padding: var(--spacing-3);
      border-bottom: 1px solid var(--border-moderate);
    }

    .output-item-title {
      flex: 1;
      display: flex;
      align-items: center;
      gap: var(--spacing-2);
      font-size: 16px;
      font-weight: var(--font-weight-medium);
      line-height: 24px;
      color: var(--text-primary);
    }

    .output-item-tag {
      display: flex;
      align-items: center;
      gap: var(--spacing-05);
      background: var(--color-primary-25);
      border: 1px solid var(--button-border-primary-disabled);
      border-radius: var(--radius-md);
      height: 32px;
      padding: var(--spacing-05) var(--spacing-1);
    }

    .output-item-tag-icon {
      width: 20px;
      height: 20px;
    }

    .output-item-tag-text {
      font-size: 14px;
      font-weight: var(--font-weight-medium);
      line-height: 20px;
      color: var(--text-brand);
    }

    .output-item-tag-badge {
      background: var(--color-primary-50);
      border-radius: var(--radius-sm);
      height: 24px;
      padding: var(--spacing-025) var(--spacing-1);
      font-size: 12px;
      font-weight: var(--font-weight-semibold);
      line-height: 18px;
      color: var(--color-primary-500);
    }

    .output-item-content {
      padding: var(--spacing-3);
      width: 100%;
      box-sizing: border-box;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }

    .output-summary {
      font-size: 16px;
      font-weight: var(--font-weight-medium);
      line-height: 24px;
      color: var(--text-primary);
      margin-bottom: var(--spacing-2);
      max-height: 120px;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 5;
      -webkit-box-orient: vertical;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }

    .expand-link {
      display: flex;
      align-items: center;
      gap: var(--spacing-1);
      font-size: 16px;
      font-weight: var(--font-weight-medium);
      line-height: 24px;
      color: var(--text-brand);
      cursor: pointer;
    }

    .expand-icon {
      width: 16px;
      height: 16px;
    }

    .output-details {
      padding-top: var(--spacing-1);
    }

    .output-section {
      margin-bottom: var(--spacing-3);
    }

    .output-section-header {
      display: flex;
      align-items: center;
      gap: var(--spacing-2);
      margin-bottom: var(--spacing-3);
    }

    .output-section-title {
      font-size: 16px;
      font-weight: var(--font-weight-medium);
      line-height: 24px;
      color: var(--text-primary);
    }

    .output-field {
      display: flex;
      gap: var(--spacing-1);
      padding: var(--spacing-0);
      margin-bottom: var(--spacing-3);
    }

    .output-field-key {
      min-width: 250px;
      max-width: 250px;
      font-size: 16px;
      font-weight: var(--font-weight-medium);
      line-height: 24px;
      color: var(--text-secondary);
    }

    .output-field-value {
      font-size: 16px;
      font-weight: var(--font-weight-medium);
      line-height: 24px;
      color: var(--text-primary);
    }

    .nested-section {
      padding-left: var(--spacing-6);
    }

    /* Responsive */
    @media (max-width: 1720px) {
      .main-layout {
        grid-template-columns: 1fr;
      }

      .panel--left {
        border-right: none;
        border-bottom: 1px solid var(--border-moderate);
      }
    }

    @media (max-width: 768px) {
      :root {
        --side-margin: var(--spacing-6);
      }

      .top-nav-container {
        grid-template-columns: var(--spacing-9) var(--spacing-3) 1fr var(--spacing-6);
      }

      .top-nav-right {
        display: none;
      }

      .main-layout {
        grid-template-columns: 1fr;
      }

      .panel {
        border-right: none;
        border-bottom: 1px solid var(--border-moderate);
      }
    }
  </style>
</head>
<body>
  <!-- Top Navigation -->
  <nav class="top-nav">
    <div class="top-nav-container">
      <div class="logo-container">
        <svg class="logo" width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M31.2005 21.0088C31.8958 18.8888 32.1416 16.6472 31.9221 14.4269C31.7026 12.2066 31.0225 10.0565 29.9255 8.11375L18.9179 7.835V7.69735L29.5131 7.42893C28.2335 5.41459 26.5217 3.71014 24.502 2.43907L15.9997 2.22571V2.08863L23.5562 1.89764C20.4599 0.23786 16.9033 -0.356312 13.4357 0.206891C9.96805 0.770094 6.7823 2.45934 4.37048 5.01372L13.8793 5.25461V5.39226L3.80209 5.64463C1.34301 8.53411 -0.00507487 12.2058 4.50478e-05 16C4.50478e-05 16.1721 4.49159e-05 16.3384 0.00864813 16.507C0.00802452 16.5183 0.00802452 16.5296 0.00864813 16.5409L3.80668 16.6372V16.7749L0.0212662 16.8707C0.0218773 16.8819 0.0218773 16.8932 0.0212662 16.9045C0.159587 19.4013 0.884457 21.8304 2.13708 23.9947L8.46733 24.1547V24.2924L2.40837 24.4461C3.89455 26.8322 5.9808 28.7865 8.45873 30.1139C8.65603 30.2211 8.85562 30.3227 9.05808 30.4202V17.1293H10.5929C10.652 17.1293 10.7105 17.1408 10.7651 17.1634C10.8197 17.186 10.8693 17.2191 10.911 17.2609C10.9528 17.3026 10.9859 17.3522 11.0085 17.4068C11.0311 17.4614 11.0426 17.5199 11.0426 17.579V31.2168C14.265 32.2611 17.735 32.2611 20.9575 31.2168V17.579C20.9574 17.5199 20.969 17.4614 20.9916 17.4068C21.0141 17.3522 21.0472 17.3026 21.089 17.2609C21.1308 17.2191 21.1804 17.186 21.235 17.1634C21.2896 17.1408 21.3481 17.1293 21.4071 17.1293H22.9408V30.4219C23.1404 30.3255 23.3394 30.2246 23.5339 30.1196C25.0987 29.2837 26.5136 28.1935 27.7207 26.8934L23.7466 26.7925V26.6548L28.0345 26.5464C29.3499 25.0482 30.373 23.3168 31.0508 21.4418L25.3291 21.2967V21.1591L31.2005 21.0088ZM25.1604 16.7072H6.8396L6.50866 15.3846H9.05808V13.9668H9.57886C9.76475 13.9669 9.9488 14.0036 10.1205 14.0748C10.2922 14.146 10.4482 14.2503 10.5796 14.3818C10.711 14.5133 10.8152 14.6694 10.8863 14.8412C10.9573 15.0129 10.9939 15.197 10.9938 15.3829H15.0086V13.4948H5.28242C5.09257 11.9835 4.19555 10.8031 4.19555 10.8031C6.8396 11.4162 15.9997 11.4638 15.9997 11.4638C15.9997 11.4638 25.1599 11.4162 27.8028 10.8031C27.8028 10.8031 26.9075 11.9835 26.7176 13.4948H16.992V15.3835H21.0068C21.0068 15.1975 21.0434 15.0133 21.1146 14.8414C21.1859 14.6696 21.2902 14.5134 21.4218 14.3819C21.5533 14.2504 21.7095 14.1461 21.8814 14.075C22.0532 14.0039 22.2374 13.9673 22.4235 13.9674H22.9431V15.3835H25.4937L25.1604 16.7072Z" fill="#431D93"/>
        </svg>
      </div>
      <div class="breadcrumbs">
        <h1 class="breadcrumb-title" id="pipeline-name"></h1>
      </div>
      <div class="top-nav-right">
        <button class="nav-button" onclick="window.open('/docs', '_blank')">API Docs</button>
        <button class="nav-button" onclick="window.open('/redoc', '_blank')">ReDoc</button>
        <button class="nav-button" onclick="window.open('/health', '_blank')">Health</button>
        <button class="nav-button" onclick="window.open('/info', '_blank')">Info</button>
        <button class="nav-button" onclick="window.open('/metrics', '_blank')">Metrics</button>
      </div>
    </div>
  </nav>

  <!-- Deployment Header -->
  <header class="deployment-header">
    <div class="deployment-header-content">
      <div class="deployment-header-left">
        <h2 class="deployment-title" id="deployment-title"></h2>
        <div class="status-badge" id="status-badge">
          <span class="status-dot"></span>
          <span>Running</span>
      </div>
      </div>
      <div class="deployment-header-right">
        <button class="share-button">Share</button>
        <button class="more-button">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <circle cx="12" cy="12" r="1.5" fill="currentColor"/>
            <circle cx="6" cy="12" r="1.5" fill="currentColor"/>
            <circle cx="18" cy="12" r="1.5" fill="currentColor"/>
          </svg>
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main>
    <div class="main-layout">
      <!-- Left Panel: Input -->
    <section class="panel panel--left">
      <div class="panel-header">
        <div class="panel-header-content">
          <h3 class="panel-title">Input</h3>
        <div class="toggle-group">
            <button class="toggle-button active" id="toggle-form">
              <svg class="toggle-icon" viewBox="0 0 24 24" fill="none">
                <path d="M3 5H15M3 10H21M3 15H15M3 20H21" stroke="currentColor" stroke-width="2"/>
              </svg>
              <span>Form</span>
          </button>
            <button class="toggle-button" id="toggle-json">
              <svg class="toggle-icon" viewBox="0 0 24 24" fill="none">
                <rect x="4" y="4" width="16" height="16" rx="2" stroke="currentColor" stroke-width="2"/>
                <path d="M8 8H16M8 12H16M8 16H12" stroke="currentColor" stroke-width="2"/>
              </svg>
              <span>JSON</span>
          </button>
        </div>
      </div>
          </div>
        
        <div class="panel-content panel-content--left" id="input-container">
          <div id="form-view">
            <!-- Form fields will be dynamically generated here -->
        </div>
          <textarea class="json-editor hidden" id="json-input" spellcheck="false"></textarea>
      </div>

      <div class="panel-footer">
        <div class="panel-footer-content">
          <button class="btn-secondary" id="reset-btn">Reset</button>
          <button class="btn-primary" id="run-btn">Run</button>
        </div>
      </div>
    </section>

      <!-- Right Panel: Output -->
    <section class="panel panel--right">
      <div class="panel-header">
        <div class="panel-header-content">
          <h3 class="panel-title">Output</h3>
        <div class="toggle-group">
            <button class="toggle-button active" id="toggle-preview">
              <svg class="toggle-icon" viewBox="0 0 24 24" fill="none">
                <path d="M3 5H15M3 10H21M3 15H15M3 20H21" stroke="currentColor" stroke-width="2"/>
              </svg>
              <span>Preview</span>
          </button>
            <button class="toggle-button" id="toggle-json-output">
              <svg class="toggle-icon" viewBox="0 0 24 24" fill="none">
                <rect x="4" y="4" width="16" height="16" rx="2" stroke="currentColor" stroke-width="2"/>
                <path d="M8 8H16M8 12H16M8 16H12" stroke="currentColor" stroke-width="2"/>
              </svg>
              <span>JSON</span>
          </button>
        </div>
      </div>
              </div>
        
        <div class="panel-content panel-content--right" id="output-container">
              <div id="preview-output">
            <p style="text-align: center; color: var(--text-tertiary); padding: 40px;">
              Run the pipeline to see output here
            </p>
              </div>
          <textarea class="json-editor hidden" id="json-output" spellcheck="false" readonly></textarea>
            </div>

      <div class="panel-footer">
        <div class="panel-footer-content">
          <button class="btn-secondary" id="rerun-btn" disabled>Re-Run</button>
          <button class="btn-warning" id="delete-btn" disabled>Delete</button>
        </div>
      </div>
    </section>
    </div>
  </main>

  <script>
    let serviceInfo = null;
    try {
      serviceInfo = JSON.parse({{ service_info_json | tojson}});
    } catch (e) {
      console.error('Failed to parse service info: ', e);
    }
    
    let currentInputMode = 'form';
    let currentOutputMode = 'preview';
    let lastResult = null;

    function authHeaders() {
      const token = localStorage.getItem('zenml_auth_token');
      return token ? { 'Authorization': 'Bearer ' + token } : {};
    }

    async function getJSON(url) {
      const res = await fetch(url, { headers: { 'Accept': 'application/json', ...authHeaders() } });
      if (!res.ok) throw new Error(`${url} returned ${res.status}`);
      return res.json();
    }

    async function postJSON(url, body) {
      const res = await fetch(url, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', ...authHeaders() },
        body: JSON.stringify(body),
      });
      const json = await res.json().catch(() => ({}));
      if (!res.ok) throw new Error((json && json.detail) ? json.detail : ('HTTP ' + res.status));
      return json;
    }

    function getParamSchema(schema) {
      if (!schema || !schema.properties) return { properties: {}, required: [] };
      if (schema.properties.parameters && schema.properties.parameters.properties) {
        return {
          properties: schema.properties.parameters.properties,
          required: schema.properties.parameters.required || [],
        };
      }
      return { properties: schema.properties, required: schema.required || [] };
    }

    function createCollapsible(name, def, required, isRoot = true) {
      const collapsible = document.createElement('div');
      collapsible.className = 'collapsible expanded';
      
      const header = document.createElement('div');
      header.className = 'collapsible-header';
      
      const chevron = document.createElement('svg');
      chevron.className = 'chevron-icon';
      chevron.innerHTML = '<path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" fill="none"/>';
      chevron.setAttribute('viewBox', '0 0 24 24');
      
      const title = document.createElement('div');
      title.className = 'collapsible-title';
      title.textContent = name;
      
      const collapseBtn = document.createElement('button');
      collapseBtn.className = 'collapse-button';
      collapseBtn.innerHTML = `
        <svg class="collapse-icon" viewBox="0 0 24 24" fill="none">
          <path d="M4 6H20M4 18H20M4 10H14M4 14H14" stroke="currentColor" stroke-width="2"/>
        </svg>
      `;
      
      header.appendChild(chevron);
      header.appendChild(title);
      header.appendChild(collapseBtn);
      
      header.addEventListener('click', (e) => {
        if (e.target !== collapseBtn && !collapseBtn.contains(e.target)) {
          collapsible.classList.toggle('expanded');
        }
      });
      
      const content = document.createElement('div');
      content.className = 'collapsible-content';
      
      collapsible.appendChild(header);
      collapsible.appendChild(content);
      
      return { element: collapsible, content };
    }

    function createField(name, def, required) {
      const field = document.createElement('div');
      field.className = 'form-field';
      
      const label = document.createElement('div');
      label.className = 'field-label';
      
      const fieldName = document.createElement('span');
      fieldName.className = 'field-name';
      fieldName.textContent = name;
      
      if (required) {
        const requiredMark = document.createElement('span');
        requiredMark.className = 'field-required';
        requiredMark.textContent = '*';
        label.appendChild(requiredMark);
      }
      
      label.appendChild(fieldName);
      
      if (def.type) {
        const fieldType = document.createElement('span');
        fieldType.className = 'field-type';
        fieldType.textContent = def.type;
        label.appendChild(fieldType);
      }
      
      field.appendChild(label);
      
      let input;
      if (def.type === 'boolean') {
        const toggleContainer = document.createElement('div');
        toggleContainer.className = 'toggle-switch-container';
        
        const toggle = document.createElement('div');
        toggle.className = 'toggle-switch ' + (def.default ? 'on' : 'off');
        toggle.dataset.name = name;
        
        const button = document.createElement('div');
        button.className = 'toggle-switch-button';
        
        toggle.appendChild(button);
        
        const labelText = document.createElement('span');
        labelText.className = 'toggle-label';
        labelText.textContent = def.default ? 'True' : 'False';
        
        toggle.addEventListener('click', () => {
          toggle.classList.toggle('on');
          toggle.classList.toggle('off');
          labelText.textContent = toggle.classList.contains('on') ? 'True' : 'False';
        });
        
        toggleContainer.appendChild(toggle);
        toggleContainer.appendChild(labelText);
        field.appendChild(toggleContainer);
      } else if (def.type === 'integer' || def.type === 'number') {
        input = document.createElement('input');
        input.type = 'number';
        input.className = 'text-input filled';
        input.name = name;
        input.value = def.default || 0;
        if (def.enum) {
          const select = document.createElement('select');
          select.className = 'select-input';
          select.name = name;
          def.enum.forEach(opt => {
            const option = document.createElement('option');
            option.value = opt;
            option.textContent = opt;
            select.appendChild(option);
          });
          select.value = def.default || def.enum[0];
          field.appendChild(select);
        } else {
          field.appendChild(input);
        }
      } else if (def.type === 'object' || def.type === 'array') {
        const { element, content } = createCollapsible(name, def, required, false);
        if (def.properties) {
          Object.entries(def.properties).forEach(([key, value]) => {
            const subField = createField(key, value, def.required?.includes(key));
            content.appendChild(subField);
          });
        }
        return element;
      } else if (def.enum) {
        const select = document.createElement('select');
        select.className = 'select-input';
        select.name = name;
        def.enum.forEach(opt => {
          const option = document.createElement('option');
          option.value = opt;
          option.textContent = opt;
          select.appendChild(option);
        });
        select.value = def.default || def.enum[0];
        field.appendChild(select);
      } else {
        input = document.createElement('input');
        input.type = 'text';
        input.className = 'text-input';
        input.name = name;
        input.value = def.default || '';
        input.placeholder = def.default || '';
        
        if (input.value) {
          input.classList.add('filled');
        }
        
        input.addEventListener('input', () => {
          if (input.value) {
            input.classList.add('filled');
          } else {
            input.classList.remove('filled');
          }
        });
        
        field.appendChild(input);
      }
      
      return field;
    }

    function buildFormFields(schema) {
      const formView = document.getElementById('form-view');
      formView.innerHTML = '';
      
        const ps = getParamSchema(schema);
        const props = ps.properties || {};
        const req = ps.required || [];
      
      if (Object.keys(props).length === 0) {
        formView.innerHTML = '<p style="color: var(--text-secondary); padding: 20px;">No input parameters defined for this pipeline.</p>';
        return;
      }
      
      Object.entries(props).forEach(([name, def]) => {
        if (def.type === 'object' && def.properties) {
          const { element, content } = createCollapsible(name, def, req.includes(name));
          Object.entries(def.properties).forEach(([key, value]) => {
            const field = createField(key, value, def.required?.includes(key));
            content.appendChild(field);
          });
          formView.appendChild(element);
        } else {
          const field = createField(name, def, req.includes(name));
          formView.appendChild(field);
        }
      });
    }

    function collectFormData() {
      // If in JSON mode, parse JSON directly
      if (currentInputMode === 'json') {
        try {
          const jsonInput = document.getElementById('json-input');
          return JSON.parse(jsonInput.value || '{}');
        } catch (e) {
          throw new Error('Invalid JSON: ' + e.message);
        }
      }
      
      // Otherwise collect from form
      const formView = document.getElementById('form-view');
      const data = {};
      
      function collectFromElement(element, target) {
        const inputs = element.querySelectorAll('input[name], select[name]');
        inputs.forEach(input => {
          const name = input.name;
          if (input.type === 'number') {
            target[name] = parseFloat(input.value) || 0;
      } else {
            target[name] = input.value;
          }
        });
        
        const toggles = element.querySelectorAll('.toggle-switch[data-name]');
        toggles.forEach(toggle => {
          const name = toggle.dataset.name;
          target[name] = toggle.classList.contains('on');
        });
        
        // Collect nested collapsible data
        const collapsibles = element.querySelectorAll('.collapsible');
        collapsibles.forEach(coll => {
          const title = coll.querySelector('.collapsible-title');
          if (title) {
            const name = title.textContent.trim();
            const content = coll.querySelector('.collapsible-content');
            if (content) {
              const nestedData = {};
              collectFromElement(content, nestedData);
              if (Object.keys(nestedData).length > 0) {
                target[name] = nestedData;
              }
            }
          }
        });
      }
      
      collectFromElement(formView, data);
      
      return data;
    }
    
    function syncFormToJson() {
      const data = collectFormData();
      const jsonInput = document.getElementById('json-input');
      jsonInput.value = JSON.stringify(data, null, 2);
    }
    
    function syncJsonToForm() {
      try {
        const jsonInput = document.getElementById('json-input');
        const data = JSON.parse(jsonInput.value || '{}');
        
        // Update form fields with JSON data
        Object.entries(data).forEach(([key, value]) => {
          const input = document.querySelector(`input[name="${key}"], select[name="${key}"]`);
          if (input) {
            input.value = value;
            if (input.classList.contains('text-input')) {
              input.classList.toggle('filled', !!value);
            }
          }
          
          const toggle = document.querySelector(`.toggle-switch[data-name="${key}"]`);
          if (toggle) {
            if (value) {
              toggle.classList.add('on');
              toggle.classList.remove('off');
          } else {
              toggle.classList.add('off');
              toggle.classList.remove('on');
            }
            const label = toggle.parentElement.querySelector('.toggle-label');
            if (label) label.textContent = value ? 'True' : 'False';
          }
        });
      } catch (e) {
        console.error('Failed to sync JSON to form:', e);
      }
    }

    async function loadPipelineInfo() {
      if (serviceInfo && serviceInfo.pipeline) {
        const pipelineName = serviceInfo.pipeline.name;
        document.getElementById('pipeline-name').textContent = pipelineName;
        document.getElementById('deployment-title').textContent = pipelineName;
        
        buildFormFields(serviceInfo.pipeline.input_schema);
        
        // Initialize JSON view with default values
        syncFormToJson();
      }
    }

    function displayOutput(result) {
      const outputView = document.getElementById('preview-output');
      outputView.innerHTML = '';
      
      // Run card
      const runCard = document.createElement('div');
      runCard.className = 'run-card';
      runCard.innerHTML = `
        <div class="run-card-header">
          <div>
            <div class="run-label">Run</div>
            <div class="run-id">
              <span class="run-id-prefix">#3488-</span>
              <span>customer-support-agent-${new Date().toISOString().slice(0,10).replace(/-/g,'')}</span>
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                <circle cx="8" cy="8" r="6" fill="#1cbf4a"/>
                <path d="M6 8L7.5 9.5L10 6.5" stroke="white" stroke-width="1.5" fill="none"/>
              </svg>
            </div>
          </div>
          <div class="run-actions">
            <button class="nav-button">Run Details</button>
            <button class="nav-button">Share</button>
          </div>
        </div>
        <div class="run-footer">
          <div class="run-status">
            <span class="run-status-completed">Completed</span>
            <span> Â· 20s</span>
          </div>
        </div>
      `;
      outputView.appendChild(runCard);
      
      // Output data
      if (result && result.outputs) {
        Object.entries(result.outputs).forEach(([key, value]) => {
          const outputItem = createOutputItem(key, value);
          outputView.appendChild(outputItem);
        });
      }
      
      document.getElementById('rerun-btn').disabled = false;
      document.getElementById('delete-btn').disabled = false;
      
      // Also update JSON output
      if (currentOutputMode === 'json') {
        document.getElementById('json-output').value = JSON.stringify(result, null, 2);
      }
    }

    function createOutputItem(key, value) {
      const item = document.createElement('div');
      item.className = 'output-item';
      
      const header = document.createElement('div');
      header.className = 'output-item-header';
      
      const chevron = document.createElement('svg');
      chevron.className = 'chevron-icon';
      chevron.innerHTML = '<path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" fill="none"/>';
      chevron.setAttribute('viewBox', '0 0 24 24');
      
      const title = document.createElement('div');
      title.className = 'output-item-title';
      title.textContent = key;
      
      const tag = document.createElement('div');
      tag.className = 'output-item-tag';
      tag.innerHTML = `
        <svg class="output-item-tag-icon" viewBox="0 0 20 20" fill="none">
          <path d="M4 6L10 4L16 6V10C16 14 10 16 10 16C10 16 4 14 4 10V6Z" stroke="currentColor" stroke-width="1.5" fill="none"/>
        </svg>
        <span class="output-item-tag-text">${key}</span>
        <span class="output-item-tag-badge">#2</span>
      `;
      
      const collapseBtn = document.createElement('button');
      collapseBtn.className = 'collapse-button';
      collapseBtn.innerHTML = `
        <svg class="collapse-icon" viewBox="0 0 24 24" fill="none">
          <path d="M4 6H20M4 18H20M4 10H14M4 14H14" stroke="currentColor" stroke-width="2"/>
        </svg>
      `;
      
      header.appendChild(chevron);
      header.appendChild(title);
      header.appendChild(tag);
      header.appendChild(collapseBtn);
      
      const content = document.createElement('div');
      content.className = 'output-item-content';
      
      if (typeof value === 'object') {
        renderObject(value, content, key);
      } else {
        content.textContent = String(value);
      }
      
      const setExpanded = (expanded) => {
        if (expanded) {
          content.style.display = 'block';
          item.classList.add('expanded');
          item.classList.remove('collapsed');
        } else {
          content.style.display = 'none';
          item.classList.remove('expanded');
          item.classList.add('collapsed');
        }
      };
      
      setExpanded(true);
      
      const toggle = () => {
        const isExpanded = item.classList.contains('expanded');
        setExpanded(!isExpanded);
      };
      
      header.addEventListener('click', (e) => {
        if (e.target !== collapseBtn && !collapseBtn.contains(e.target)) {
          toggle();
        }
      });
      collapseBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        toggle();
      });
      
      item.appendChild(header);
      item.appendChild(content);
      
      return item;
    }

    function renderObject(obj, container, depth = 0) {
      Object.entries(obj).forEach(([key, value]) => {
        if (key === 'summary' && typeof value === 'string' && value.length > 200) {
          const summary = document.createElement('div');
          summary.className = 'output-summary';
          summary.textContent = value;
          
          const expandLink = document.createElement('div');
          expandLink.className = 'expand-link';
          expandLink.innerHTML = `
            <svg class="expand-icon" viewBox="0 0 16 16" fill="none">
              <path d="M4 6H12M4 12H12M4 8H10M4 10H10" stroke="currentColor" stroke-width="1.5"/>
            </svg>
            <span>Expand summary</span>
          `;
          expandLink.addEventListener('click', () => {
            summary.style.maxHeight = 'none';
            summary.style.webkitLineClamp = 'unset';
            expandLink.style.display = 'none';
          });
          
          container.appendChild(summary);
          container.appendChild(expandLink);
        } else if (typeof value === 'object' && value !== null) {
          const section = document.createElement('div');
          section.className = 'output-section';
          
          const sectionHeader = document.createElement('div');
          sectionHeader.className = 'output-section-header';
          sectionHeader.innerHTML = `
            <svg class="chevron-icon" viewBox="0 0 16 16" fill="none">
              <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="1.5" fill="none"/>
            </svg>
            <span class="output-section-title">${key}</span>
          `;
          section.appendChild(sectionHeader);
          
          const nestedSection = document.createElement('div');
          nestedSection.className = 'nested-section';
          renderObject(value, nestedSection, depth + 1);
          section.appendChild(nestedSection);
          
          container.appendChild(section);
        } else {
          const field = document.createElement('div');
          field.className = 'output-field';
          field.innerHTML = `
            <div class="output-field-key">${key}</div>
            <div class="output-field-value">${value}</div>
          `;
          container.appendChild(field);
        }
      });
    }

    async function runPipeline() {
      try {
        document.getElementById('run-btn').disabled = true;
        document.getElementById('run-btn').textContent = 'Running...';
        
        const params = collectFormData();
        const result = await postJSON(serviceInfo.app.invoke_url_path, { parameters: params, timeout: 300 });

        lastResult = result;
        displayOutput(result);
      } catch (e) {
        alert('Error: ' + e.message);
      } finally {
        document.getElementById('run-btn').disabled = false;
        document.getElementById('run-btn').textContent = 'Run';
      }
    }

    // Event Listeners
    document.getElementById('run-btn').addEventListener('click', runPipeline);
    document.getElementById('reset-btn').addEventListener('click', () => {
      loadPipelineInfo();
    });
    
    document.getElementById('rerun-btn').addEventListener('click', runPipeline);
    document.getElementById('delete-btn').addEventListener('click', () => {
      document.getElementById('preview-output').innerHTML = '<p style="text-align: center; color: var(--text-tertiary); padding: 40px;">Run the pipeline to see output here</p>';
      document.getElementById('json-output').value = '';
      document.getElementById('rerun-btn').disabled = true;
      document.getElementById('delete-btn').disabled = true;
      lastResult = null;
    });

    // Toggle handlers
    document.getElementById('toggle-form').addEventListener('click', () => {
      document.getElementById('toggle-form').classList.add('active');
      document.getElementById('toggle-json').classList.remove('active');
      document.getElementById('form-view').classList.remove('hidden');
      document.getElementById('json-input').classList.add('hidden');
      currentInputMode = 'form';
    });

    document.getElementById('toggle-json').addEventListener('click', () => {
      // Sync current form data to JSON before switching
      syncFormToJson();
      
      document.getElementById('toggle-json').classList.add('active');
      document.getElementById('toggle-form').classList.remove('active');
      document.getElementById('form-view').classList.add('hidden');
      document.getElementById('json-input').classList.remove('hidden');
      currentInputMode = 'json';
    });

    document.getElementById('toggle-preview').addEventListener('click', () => {
      document.getElementById('toggle-preview').classList.add('active');
      document.getElementById('toggle-json-output').classList.remove('active');
      document.getElementById('preview-output').classList.remove('hidden');
      document.getElementById('json-output').classList.add('hidden');
      currentOutputMode = 'preview';
    });

    document.getElementById('toggle-json-output').addEventListener('click', () => {
      document.getElementById('toggle-json-output').classList.add('active');
      document.getElementById('toggle-preview').classList.remove('active');
      document.getElementById('preview-output').classList.add('hidden');
      document.getElementById('json-output').classList.remove('hidden');
      currentOutputMode = 'json';
      
      if (lastResult) {
        document.getElementById('json-output').value = JSON.stringify(lastResult, null, 2);
      }
    });

    // Initialize
    loadPipelineInfo();
  </script>
</body>
</html>