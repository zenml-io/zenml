import{j as s}from"./@radix-sxciy0xP.js";import{P as j}from"./Pagination-Cy9GOc-F.js";import{b8 as x,e as m,a3 as y,B as g,b9 as v,r as u,a0 as p,b3 as S,b6 as b,aH as D,aI as N}from"./index-Duh0NHGE.js";import{b as h}from"./@tanstack-BjpQvXOk.js";import{S as C}from"./refresh-DhdtzFSJ.js";import{c as P}from"./helper-BTn5fNf0.js";import{S as w}from"./SearchField-n90qDd-b.js";import{B as F}from"./button-group-basic-DYM6F7CL.js";import{f as R,L as d}from"./@react-router-B8Rvl3f4.js";import{z as o}from"./@zod-3snSrKBm.js";import{D as T}from"./deployment-status-tag--oYSgHCy.js";import{P as B}from"./pipeline-link-CtXAhVuF.js";const{ContextProvider:K,useContext:c}=P();function M({params:t,columns:e}){const{rowSelection:a,setRowSelection:r}=c(),n=h({...x.list(t),throwOnError:!0});if(n.isPending)return s.jsxs("div",{className:"flex flex-col items-center gap-5",children:[s.jsx("div",{className:"w-full",children:s.jsx(m,{className:"h-[500px] w-full"})}),s.jsx(m,{className:"h-[36px] w-[300px]"})]});if(n.isError)return s.jsx("p",{children:"Error fetching deployments"});const i=n.data;return s.jsxs("div",{className:"flex flex-col items-center gap-5",children:[s.jsx("div",{className:"w-full",children:s.jsx(y,{columns:e,data:i.items,rowSelection:a,onRowSelectionChange:r,getRowId:f=>f.id})}),i.total_pages>1&&s.jsx(j,{searchParams:t,paginate:i})]})}function k(){const{selectedRowCount:t}=c();async function e(){}return s.jsx(F,{itemName:"Pipeline Snapshot",selectedItemCount:t,onDeleteSelected:e})}function V({params:t}){const{refetch:e}=h({...x.list(t),throwOnError:!0}),{selectedRowCount:a}=c();return s.jsxs("div",{className:"flex items-center justify-between",children:[a?s.jsx(k,{}):s.jsx(w,{searchParams:t}),s.jsxs(g,{intent:"primary",emphasis:"subtle",size:"md",onClick:()=>e(),children:[s.jsx(C,{className:"h-5 w-5 fill-theme-text-brand"}),"Refresh"]})]})}const l=1,E=o.object({page:o.coerce.number().min(l).optional().default(l).catch(l),name:o.string().optional(),operator:o.enum(["and","or"]).optional()});function W(){const[t]=R(),{page:e,name:a,operator:r}=E.parse({page:t.get("page")||void 0,name:t.get("name")||void 0});return{page:e,name:a,logical_operator:r}}function X(){return{id:"name",header:"Deployment",accessorFn:t=>t.name,cell:({row:t})=>{const e=t.original.name,a=t.original.id;return s.jsxs("div",{className:"group/copybutton flex items-center gap-2",children:[s.jsx(v,{className:"h-5 w-5 fill-primary-400"}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(d,{to:u.projects.deployments.detail.overview(a),className:"flex items-center gap-1",children:s.jsx("span",{className:"text-text-md font-semibold text-theme-text-primary",children:e??"Unnamed"})}),s.jsx(p,{copyText:e??""})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(d,{to:u.projects.deployments.detail.overview(a),className:"flex items-center gap-1",children:s.jsx("p",{className:"text-text-xs text-theme-text-secondary",children:S(a)})}),s.jsx(p,{copyText:a})]})]})]})}}}function Y(){return{id:"status",header:"Status",accessorFn:t=>{var e;return(e=t.body)==null?void 0:e.status},cell:({row:t})=>{var a;const e=(a=t.original.body)==null?void 0:a.status;return e?s.jsx(T,{size:"sm",status:e}):s.jsx("div",{children:"No status"})}}}function Z(){return{id:"pipeline",header:"Pipeline",accessorFn:t=>{var e,a;return(a=(e=t.resources)==null?void 0:e.pipeline)==null?void 0:a.name},cell:({row:t})=>{var a;const e=(a=t.original.resources)==null?void 0:a.pipeline;return e?s.jsx(B,{pipelineId:e.id,pipelineName:e.name}):null}}}function $(){return{id:"snapshot",header:"Snapshot",accessorFn:t=>{var e,a;return(a=(e=t.resources)==null?void 0:e.snapshot)==null?void 0:a.name},cell:({row:t})=>{var n;const e=(n=t.original.resources)==null?void 0:n.snapshot,a=e==null?void 0:e.name,r=e==null?void 0:e.id;return!a||!r?null:s.jsx(b,{size:"sm",snapshotId:r,snapshotName:a})}}}function ee(){return{id:"author",header:"Author",accessorFn:t=>{var e,a;return(a=(e=t.resources)==null?void 0:e.user)==null?void 0:a.name},cell:({row:t})=>{var a,r,n;const e=(a=t.original.resources)==null?void 0:a.user;return e?s.jsx(D,{username:e.name,isServiceAccount:!!((r=e.body)!=null&&r.is_service_account),avatarUrl:((n=e.body)==null?void 0:n.avatar_url)??void 0}):null}}}function te(){return{id:"created",header:"Created at",accessorFn:t=>{var e;return{date:(e=t.body)==null?void 0:e.created}},cell:({getValue:t})=>{const{date:e}=t();return s.jsx(N,{dateString:e})}}}export{V as D,M as P,Y as a,$ as b,X as c,ee as d,te as e,K as f,Z as g,W as u};
