
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://sdkdocs.zenml.io/0.90.0rc0/integration_code_docs/integrations-skypilot.html">
      
      
        <link rel="prev" href="integrations-sklearn.html">
      
      
        <link rel="next" href="integrations-skypilot_aws.html">
      
      
      <link rel="icon" href="../_assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.8">
    
    
      
        <title>Skypilot - ZenML SDK Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8608ea7d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    

<script>
  // Load Segment analytics library first
  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"];analytics.factory=function(e){return function(){var t=Array.prototype.slice.call(arguments);t.unshift(e);analytics.push(t);return analytics}};for(var e=0;e<analytics.methods.length;e++){var key=analytics.methods[e];analytics[key]=analytics.factory(key)}analytics.load=function(key,e){var t=document.createElement("script");t.type="text/javascript";t.async=!0;t.src="https://cdn.segment.com/analytics.js/v1/" + key + "/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n);analytics._loadOptions=e};analytics._writeKey="CaE5VaNjhyaUt48qXK4rLwwKJ0PdAOFM";;analytics.SNIPPET_VERSION="4.15.3";
  analytics.load("CaE5VaNjhyaUt48qXK4rLwwKJ0PdAOFM");
  
  // Bot detection function
  function isBotTraffic() {
    const userAgent = navigator.userAgent || '';
    
    // Check for specific bot signatures found in your traffic
    const botSignatures = [
      'ClaudeBot',           // The main culprit from your debugger data
      'HeadlessChrome',      // Also found in your userAgentData
      'crawler',
      'spider',
      'bot',
      'scraper',
      'Googlebot',
      'Bingbot',
      'SemrushBot',
      'AhrefsBot'
    ];
    
    // Check user agent string
    for (let signature of botSignatures) {
      if (userAgent.toLowerCase().includes(signature.toLowerCase())) {
        return true;
      }
    }
    
    // Check userAgentData brands (modern bot detection)
    try {
      if (navigator.userAgentData && navigator.userAgentData.brands) {
        const brands = navigator.userAgentData.brands;
        for (let brand of brands) {
          // Check for specific bot signatures in brand names
          if (brand.brand === 'HeadlessChrome' || 
              /^Not.?A_Brand$/i.test(brand.brand) || // Matches 'Not?A_Brand' and similar variations
              brand.brand.toLowerCase().includes('bot')) {
            return true;
          }
        }
      }
    } catch (e) {
      // userAgentData API not supported or error accessing it
      // Continue with other bot detection methods
    }
    
    // Check for webdriver (automated browser indicator)
    if (navigator.webdriver === true) {
      return true;
    }
    
    return false;
  }
  
  // Only send analytics data if this is NOT bot traffic
  if (!isBotTraffic()) {
    analytics.page();
  } else {
    // Optional: Log for debugging (only in non-production environments)
    if (window.location.hostname === 'localhost' || window.location.hostname.includes('dev')) {
      console.log('Bot traffic detected, skipping Segment analytics');
    }
  }
  }}();
</script>

<!-- Plausible and Reo continue unchanged -->
<script defer data-domain="apidocs.zenml.io" src="https://plausible.io/js/plausible.js"></script>

<!-- Start of Reo Javascript -->
<script type="text/javascript">
  !function(){var e,t,n;e="4d2a332d9b3113a",t=function(){Reo.init({clientID:"4d2a332d9b3113a"})},(n=document.createElement("script")).src="https://static.reo.dev/"+e+"/reo.js",n.defer=!0,n.onload=t,document.head.appendChild(n)}();
</script>
<!-- End of Reo Javascript -->


  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#skypilot" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="ZenML SDK Docs" class="md-header__button md-logo" aria-label="ZenML SDK Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ZenML SDK Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Skypilot
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/zenml-io/zenml" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="ZenML SDK Docs" class="md-nav__button md-logo" aria-label="ZenML SDK Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    ZenML SDK Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zenml-io/zenml" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ZenML
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLI docs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Core code docs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Core code docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-actions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Actions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-alerter.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Alerter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-analytics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Analytics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-annotators.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Annotators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-artifact_stores.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Artifact Stores
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-artifacts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Artifacts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-client.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Client
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-client_lazy_loader.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Client Lazy Loader
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-code_repositories.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code Repositories
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-config.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-console.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Console
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-constants.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constants
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-container_registries.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Container Registries
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-data_validators.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Validators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-deployers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deployers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-entrypoints.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Entrypoints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-enums.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enums
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-environment.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Environment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-event_hub.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Event Hub
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-event_sources.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Event Sources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-exceptions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exceptions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-experiment_trackers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Experiment Trackers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-feature_stores.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feature Stores
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-hooks.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hooks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-image_builders.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Image Builders
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-io.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Io
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-logger.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-logging.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-login.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Login
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-materializers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Materializers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-metadata.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metadata
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-model.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-model_deployers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Deployers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-model_registries.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Registries
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-models.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-orchestrators.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Orchestrators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-pipelines.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pipelines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-plugins.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plugins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-secret.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secret
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-service_connectors.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Service Connectors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-services.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-stack.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-stack_deployments.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stack Deployments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-step_operators.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step Operators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-steps.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Steps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-types.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-utils.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-zen_server.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Zen Server
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_code_docs/core-zen_stores.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Zen Stores
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Integration code docs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Integration code docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-airflow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Airflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-argilla.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Argilla
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-aws.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aws
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-azure.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-bentoml.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bentoml
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-bitbucket.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bitbucket
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-comet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Comet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-constants.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constants
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-databricks.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Databricks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-deepchecks.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deepchecks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-discord.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Discord
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-evidently.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evidently
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-facets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Facets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-feast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feast
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-gcp.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gcp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-github.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Github
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-gitlab.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gitlab
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-great_expectations.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Great Expectations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-huggingface.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Huggingface
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-hyperai.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hyperai
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-integration.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-jax.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jax
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-kaniko.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kaniko
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-kubeflow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubeflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-kubernetes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubernetes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-label_studio.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Label Studio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-langchain.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Langchain
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-lightgbm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lightgbm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-lightning.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lightning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-llama_index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Llama Index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-mlflow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mlflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-modal.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-neptune.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neptune
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-neural_prophet.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neural Prophet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-numpy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Numpy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-openai.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Openai
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-pandas.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pandas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-pigeon.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pigeon
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-pillow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pillow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-polars.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Polars
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-prodigy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prodigy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-pycaret.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pycaret
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-pytorch.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pytorch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-pytorch_lightning.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pytorch Lightning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-registry.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Registry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-s3.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    S3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-scipy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scipy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-seldon.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seldon
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-sklearn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sklearn
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Skypilot
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="integrations-skypilot.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Skypilot
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot" class="md-nav__link">
    <span class="md-ellipsis">
      skypilot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="skypilot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Modules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.flavors" class="md-nav__link">
    <span class="md-ellipsis">
      flavors
    </span>
  </a>
  
    <nav class="md-nav" aria-label="flavors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.flavors-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Modules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config" class="md-nav__link">
    <span class="md-ellipsis">
      skypilot_orchestrator_base_vm_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.orchestrators" class="md-nav__link">
    <span class="md-ellipsis">
      orchestrators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="orchestrators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.orchestrators-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.orchestrators.SkypilotBaseOrchestrator" class="md-nav__link">
    <span class="md-ellipsis">
      SkypilotBaseOrchestrator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.orchestrators-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Modules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.orchestrators.skypilot_base_vm_orchestrator" class="md-nav__link">
    <span class="md-ellipsis">
      skypilot_base_vm_orchestrator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.orchestrators.skypilot_orchestrator_entrypoint" class="md-nav__link">
    <span class="md-ellipsis">
      skypilot_orchestrator_entrypoint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.orchestrators.skypilot_orchestrator_entrypoint_configuration" class="md-nav__link">
    <span class="md-ellipsis">
      skypilot_orchestrator_entrypoint_configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils" class="md-nav__link">
    <span class="md-ellipsis">
      utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils.create_docker_run_command" class="md-nav__link">
    <span class="md-ellipsis">
      create_docker_run_command
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils.prepare_docker_setup" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_docker_setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils.prepare_launch_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_launch_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils.prepare_resources_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_resources_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils.prepare_task_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_task_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils.sanitize_cluster_name" class="md-nav__link">
    <span class="md-ellipsis">
      sanitize_cluster_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils.sky_job_get" class="md-nav__link">
    <span class="md-ellipsis">
      sky_job_get
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-skypilot_aws.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skypilot Aws
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-skypilot_azure.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skypilot Azure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-skypilot_gcp.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skypilot Gcp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-skypilot_kubernetes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skypilot Kubernetes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-skypilot_lambda.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skypilot Lambda
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-slack.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Slack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-spark.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spark
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-tekton.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tekton
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-tensorboard.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tensorboard
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-tensorflow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tensorflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-utils.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-vllm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vllm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-wandb.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wandb
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-whylogs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Whylogs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="integrations-xgboost.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xgboost
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot" class="md-nav__link">
    <span class="md-ellipsis">
      skypilot
    </span>
  </a>
  
    <nav class="md-nav" aria-label="skypilot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Modules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.flavors" class="md-nav__link">
    <span class="md-ellipsis">
      flavors
    </span>
  </a>
  
    <nav class="md-nav" aria-label="flavors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.flavors-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Modules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config" class="md-nav__link">
    <span class="md-ellipsis">
      skypilot_orchestrator_base_vm_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.orchestrators" class="md-nav__link">
    <span class="md-ellipsis">
      orchestrators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="orchestrators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.orchestrators-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.orchestrators.SkypilotBaseOrchestrator" class="md-nav__link">
    <span class="md-ellipsis">
      SkypilotBaseOrchestrator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.orchestrators-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Modules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.orchestrators.skypilot_base_vm_orchestrator" class="md-nav__link">
    <span class="md-ellipsis">
      skypilot_base_vm_orchestrator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.orchestrators.skypilot_orchestrator_entrypoint" class="md-nav__link">
    <span class="md-ellipsis">
      skypilot_orchestrator_entrypoint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.orchestrators.skypilot_orchestrator_entrypoint_configuration" class="md-nav__link">
    <span class="md-ellipsis">
      skypilot_orchestrator_entrypoint_configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils" class="md-nav__link">
    <span class="md-ellipsis">
      utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils-classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils.create_docker_run_command" class="md-nav__link">
    <span class="md-ellipsis">
      create_docker_run_command
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils.prepare_docker_setup" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_docker_setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils.prepare_launch_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_launch_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils.prepare_resources_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_resources_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils.prepare_task_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_task_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils.sanitize_cluster_name" class="md-nav__link">
    <span class="md-ellipsis">
      sanitize_cluster_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.skypilot.utils.sky_job_get" class="md-nav__link">
    <span class="md-ellipsis">
      sky_job_get
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="skypilot">Skypilot</h1>


<div class="doc doc-object doc-module">



<h2 id="zenml.integrations.skypilot" class="doc doc-heading">
            <code>zenml.integrations.skypilot</code>


</h2>

    <div class="doc doc-contents first">










  <div class="doc doc-children">









<h3 id="zenml.integrations.skypilot-modules">Modules</h3>

<div class="doc doc-object doc-module">



<h4 id="zenml.integrations.skypilot.flavors" class="doc doc-heading">
            <code>flavors</code>


</h4>

    <div class="doc doc-contents ">










  <div class="doc doc-children">









<h5 id="zenml.integrations.skypilot.flavors-modules">Modules</h5>

<div class="doc doc-object doc-module">



<h6 id="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config" class="doc doc-heading">
            <code>skypilot_orchestrator_base_vm_config</code>


</h6>

    <div class="doc doc-contents ">

        <p>Skypilot orchestrator base config and settings.</p>










  <div class="doc doc-children">







<h7 id="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config-classes">Classes</h7>

<div class="doc doc-object doc-class">



<h8 id="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorConfig" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">SkypilotBaseOrchestratorConfig</span><span class="p">(</span><span class="n">warn_about_plain_text_secrets</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span></code>

</h8>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseOrchestratorConfig(warn_about_plain_text_secrets: bool = False, **kwargs: Any) (zenml.orchestrators.BaseOrchestratorConfig)" href="../core_code_docs/core-orchestrators.html#zenml.orchestrators.BaseOrchestratorConfig">BaseOrchestratorConfig</a></code>, <code><a class="autorefs autorefs-internal" title="SkypilotBaseOrchestratorSettings(warn_about_plain_text_secrets: bool = False, **kwargs: Any) (zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings)" href="#zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings">SkypilotBaseOrchestratorSettings</a></code></p>


        <p>Skypilot orchestrator base config.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorConfig.disable_step_based_settings">disable_step_based_settings</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>whether to disable step-based settings.
If True, the orchestrator will run all steps with the pipeline
settings in one single VM. If False, the orchestrator will run
each step with its own settings in separate VMs if provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="quote">
                    <summary>Source code in <code>src/zenml/stack/stack_component.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">warn_about_plain_text_secrets</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ensures that secret references don&#39;t clash with pydantic validation.</span>

<span class="sd">    StackComponents allow the specification of all their string attributes</span>
<span class="sd">    using secret references of the form `{{secret_name.key}}`. This however</span>
<span class="sd">    is only possible when the stack component does not perform any explicit</span>
<span class="sd">    validation of this attribute using pydantic validators. If this were</span>
<span class="sd">    the case, the validation would run on the secret reference and would</span>
<span class="sd">    fail or in the worst case, modify the secret reference and lead to</span>
<span class="sd">    unexpected behavior. This method ensures that no attributes that require</span>
<span class="sd">    custom pydantic validation are set as secret references.</span>

<span class="sd">    Args:</span>
<span class="sd">        warn_about_plain_text_secrets: If true, then warns about using</span>
<span class="sd">            plain-text secrets.</span>
<span class="sd">        **kwargs: Arguments to initialize this stack component.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If an attribute that requires custom pydantic validation</span>
<span class="sd">            is passed as a secret reference, or if the `name` attribute</span>
<span class="sd">            was passed as a secret reference.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="c1"># Value for a private attribute or non-existing field, this</span>
            <span class="c1"># will fail during the upcoming pydantic validation</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">secret_utils</span><span class="o">.</span><span class="n">is_secret_reference</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">secret_utils</span><span class="o">.</span><span class="n">is_secret_field</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">warn_about_plain_text_secrets</span>
            <span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;You specified a plain-text value for the sensitive &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;attribute `</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">` for a `</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">` &quot;</span>
                    <span class="s2">&quot;stack component. This is currently only a warning, &quot;</span>
                    <span class="s2">&quot;but future versions of ZenML will require you to pass &quot;</span>
                    <span class="s2">&quot;in sensitive information as secrets. Check out the &quot;</span>
                    <span class="s2">&quot;documentation on how to configure your stack &quot;</span>
                    <span class="s2">&quot;components with secrets here: &quot;</span>
                    <span class="s2">&quot;https://docs.zenml.io/deploying-zenml/deploying-zenml/secret-management&quot;</span>
                <span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">pydantic_utils</span><span class="o">.</span><span class="n">has_validators</span><span class="p">(</span>
            <span class="n">pydantic_class</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">field_name</span><span class="o">=</span><span class="n">key</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Passing the stack component attribute `</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">` as a &quot;</span>
                <span class="s2">&quot;secret reference is not allowed as additional validation &quot;</span>
                <span class="s2">&quot;is required for this attribute.&quot;</span>
            <span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">





<h9 id="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorConfig-attributes">Attributes</h9>

<div class="doc doc-object doc-attribute">



<h10 id="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorConfig.is_local" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_local</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h10>


    <div class="doc doc-contents ">

        <p>Checks if this stack component is running locally.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if this config is for a local component, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h10 id="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorConfig.supports_client_side_caching" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">supports_client_side_caching</span><span class="p">:</span> <span class="nb">bool</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h10>


    <div class="doc doc-contents ">

        <p>Whether the orchestrator supports client side caching.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the orchestrator supports client side caching.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>






  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h8 id="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">SkypilotBaseOrchestratorSettings</span><span class="p">(</span><span class="n">warn_about_plain_text_secrets</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span></code>

</h8>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseSettings(warn_about_plain_text_secrets: bool = False, **kwargs: Any) (zenml.config.base_settings.BaseSettings)" href="../core_code_docs/core-config.html#zenml.config.base_settings.BaseSettings">BaseSettings</a></code></p>


        <p>Skypilot orchestrator base settings.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.instance_type">instance_type</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the instance type to use.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.cpus">cpus</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[None, <span title="int">int</span>, <span title="float">float</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the number of CPUs required for the task.
If a str, must be a string of the form <code>'2'</code> or <code>'2+'</code>, where
the <code>+</code> indicates that the task requires at least 2 CPUs.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.memory">memory</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[None, <span title="int">int</span>, <span title="float">float</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the amount of memory in GiB required. If a
str, must be a string of the form <code>'16'</code> or <code>'16+'</code>, where
the <code>+</code> indicates that the task requires at least 16 GB of memory.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.accelerators">accelerators</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[None, <span title="str">str</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="int">int</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the accelerators required. If a str, must be
a string of the form <code>'V100'</code> or <code>'V100:2'</code>, where the <code>:2</code>
indicates that the task requires 2 V100 GPUs. If a dict, must be a
dict of the form <code>{'V100': 2}</code> or <code>{'tpu-v2-8': 1}</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.accelerator_args">accelerator_args</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>accelerator-specific arguments. For example,
<code>{'tpu_vm': True, 'runtime_version': 'tpu-vm-base'}</code> for TPUs.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.use_spot">use_spot</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>whether to use spot instances. If None, defaults to
False.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.job_recovery">job_recovery</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[None, <span title="str">str</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the spot recovery strategy to use for the managed
spot to recover the cluster from preemption. Refer to
<code>recovery_strategy module &lt;https://github.com/skypilot-org/skypilot/blob/master/sky/spot/recovery_strategy.py&gt;</code>__ # pylint: disable=line-too-long
for more details.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.region">region</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the region to use.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.zone">zone</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the zone to use.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.image_id">image_id</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>], <span title="str">str</span>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the image ID to use. If a str, must be a string
of the image id from the cloud, such as AWS:
<code>'ami-1234567890abcdef0'</code>, GCP:
<code>'projects/my-project-id/global/images/my-image-name'</code>;
Or, a image tag provided by SkyPilot, such as AWS:
<code>'skypilot:gpu-ubuntu-2004'</code>. If a dict, must be a dict mapping
from region to image ID, such as:</p>
<p>.. code-block:: python</p>
<pre><code>{
'us-west1': 'ami-1234567890abcdef0',
'us-east1': 'ami-1234567890abcdef0'
}
</code></pre>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.disk_size">disk_size</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the size of the OS disk in GiB.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.disk_tier">disk_tier</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Literal">Literal</span>[&#39;high&#39;, &#39;medium&#39;, &#39;low&#39;, &#39;ultra&#39;, &#39;best&#39;]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the disk performance tier to use. If None, defaults to
<code>'medium'</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.ports">ports</span></code></td>
            <td>
                  <code><span title="typing.Union">Union</span>[None, <span title="int">int</span>, <span title="str">str</span>, <span title="typing.List">List</span>[<span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="str">str</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ports to expose. Could be an integer, a range, or a list of
integers and ranges. All ports will be exposed to the public internet.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.labels">labels</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels to apply to instances as key-value pairs. These are
mapped to cloud-specific implementations (instance tags in AWS,
instance labels in GCP, etc.)</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.any_of">any_of</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of candidate resources to try in order of preference based on
cost (determined by the optimizer).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.ordered">ordered</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of candidate resources to try in the specified order.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.cluster_name">cluster_name</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name of the cluster to create/reuse.  If None,
auto-generate a name.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.retry_until_up">retry_until_up</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>whether to retry launching the cluster until it is
up.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.idle_minutes_to_autostop">idle_minutes_to_autostop</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>automatically stop the cluster after this
many minute of idleness, i.e., no running or pending jobs in the
cluster's job queue. Idleness gets reset whenever setting-up/
running/pending jobs are found in the job queue. Setting this
flag is equivalent to running
<code>sky.launch(..., detach_run=True, ...)</code> and then
<code>sky.autostop(idle_minutes=&lt;minutes&gt;)</code>. If not set, the cluster
will not be autostopped.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.down">down</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tear down the cluster after all jobs finish (successfully or
abnormally). If --idle-minutes-to-autostop is also set, the
cluster will be torn down after the specified idle time.
Note that if errors occur during provisioning/data syncing/setting
up, the cluster will not be torn down for debugging purposes.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.stream_logs">stream_logs</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if True, show the logs in the terminal.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.docker_run_args">docker_run_args</span></code></td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional arguments to pass to the <code>docker run</code> command
running inside the VM.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.workdir">workdir</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Working directory to sync to the VM. Synced to ~/sky_workdir.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.task_name">task_name</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Task name used for display purposes.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.file_mounts">file_mounts</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File and storage mounts configuration for remote cluster.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.envs">envs</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Environment variables for the task.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.task_settings">task_settings</span></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of arbitrary settings to pass to sky.Task().
This allows passing future parameters added by SkyPilot without
requiring updates to ZenML.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.resources_settings">resources_settings</span></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of arbitrary settings to pass to
sky.Resources(). This allows passing future parameters added
by SkyPilot without requiring updates to ZenML.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings.launch_settings">launch_settings</span></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of arbitrary settings to pass to
sky.launch(). This allows passing future parameters added
by SkyPilot without requiring updates to ZenML.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








                  <details class="quote">
                    <summary>Source code in <code>src/zenml/config/secret_reference_mixin.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">warn_about_plain_text_secrets</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ensures that secret references are only passed for valid fields.</span>

<span class="sd">    This method ensures that secret references are not passed for fields</span>
<span class="sd">    that explicitly prevent them or require pydantic validation.</span>

<span class="sd">    Args:</span>
<span class="sd">        warn_about_plain_text_secrets: If true, then warns about using plain-text secrets.</span>
<span class="sd">        **kwargs: Arguments to initialize this object.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If an attribute that requires custom pydantic validation</span>
<span class="sd">            or an attribute which explicitly disallows secret references</span>
<span class="sd">            is passed as a secret reference.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">field</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">model_fields</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="c1"># Value for a private attribute or non-existing field, this</span>
            <span class="c1"># will fail during the upcoming pydantic validation</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">secret_utils</span><span class="o">.</span><span class="n">is_secret_reference</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">secret_utils</span><span class="o">.</span><span class="n">is_secret_field</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">warn_about_plain_text_secrets</span>
            <span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;You specified a plain-text value for the sensitive &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;attribute `</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">`. This is currently only a warning, &quot;</span>
                    <span class="s2">&quot;but future versions of ZenML will require you to pass &quot;</span>
                    <span class="s2">&quot;in sensitive information as secrets. Check out the &quot;</span>
                    <span class="s2">&quot;documentation on how to configure values with secrets &quot;</span>
                    <span class="s2">&quot;here: https://docs.zenml.io/deploying-zenml/deploying-zenml/secret-management&quot;</span>
                <span class="p">)</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">secret_utils</span><span class="o">.</span><span class="n">is_clear_text_field</span><span class="p">(</span><span class="n">field</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Passing the `</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">` attribute as a secret reference is &quot;</span>
                <span class="s2">&quot;not allowed.&quot;</span>
            <span class="p">)</span>

        <span class="n">requires_validation</span> <span class="o">=</span> <span class="n">has_validators</span><span class="p">(</span>
            <span class="n">pydantic_class</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">field_name</span><span class="o">=</span><span class="n">key</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">requires_validation</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Passing the attribute `</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">` as a secret reference is &quot;</span>
                <span class="s2">&quot;not allowed as additional validation is required for &quot;</span>
                <span class="s2">&quot;this attribute.&quot;</span>
            <span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>
<h7 id="zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config-functions">Functions</h7>



  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="zenml.integrations.skypilot.orchestrators" class="doc doc-heading">
            <code>orchestrators</code>


</h4>

    <div class="doc doc-contents ">

        <p>Initialization of the Skypilot ZenML orchestrators.</p>










  <div class="doc doc-children">







<h5 id="zenml.integrations.skypilot.orchestrators-classes">Classes</h5>

<div class="doc doc-object doc-class">



<h6 id="zenml.integrations.skypilot.orchestrators.SkypilotBaseOrchestrator" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">SkypilotBaseOrchestrator</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="n">UUID</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">StackComponentConfig</span><span class="p">,</span> <span class="n">flavor</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="n">StackComponentType</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UUID</span><span class="p">],</span> <span class="n">created</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">updated</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">environment</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">secrets</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">UUID</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">connector_requirements</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ServiceConnectorRequirements</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">connector</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UUID</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">connector_resource_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span></code>

</h6>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ContainerizedOrchestrator(name: str, id: UUID, config: StackComponentConfig, flavor: str, type: StackComponentType, user: Optional[UUID], created: datetime, updated: datetime, environment: Optional[Dict[str, str]] = None, secrets: Optional[List[UUID]] = None, labels: Optional[Dict[str, Any]] = None, connector_requirements: Optional[ServiceConnectorRequirements] = None, connector: Optional[UUID] = None, connector_resource_id: Optional[str] = None, *args: Any, **kwargs: Any) (zenml.orchestrators.ContainerizedOrchestrator)" href="../core_code_docs/core-orchestrators.html#zenml.orchestrators.ContainerizedOrchestrator">ContainerizedOrchestrator</a></code></p>


        <p>Base class for Orchestrator responsible for running pipelines remotely in a VM.</p>
<p>This orchestrator does not support running on a schedule.</p>








                  <details class="quote">
                    <summary>Source code in <code>src/zenml/stack/stack_component.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">UUID</span><span class="p">,</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">StackComponentConfig</span><span class="p">,</span>
    <span class="n">flavor</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">StackComponentType</span><span class="p">,</span>
    <span class="n">user</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UUID</span><span class="p">],</span>
    <span class="n">created</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="n">updated</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="n">environment</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">secrets</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">UUID</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">connector_requirements</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ServiceConnectorRequirements</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">connector</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UUID</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">connector_resource_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes a StackComponent.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: The name of the component.</span>
<span class="sd">        id: The unique ID of the component.</span>
<span class="sd">        config: The config of the component.</span>
<span class="sd">        flavor: The flavor of the component.</span>
<span class="sd">        type: The type of the component.</span>
<span class="sd">        user: The ID of the user who created the component.</span>
<span class="sd">        created: The creation time of the component.</span>
<span class="sd">        updated: The last update time of the component.</span>
<span class="sd">        environment: Environment variables to set when running on this</span>
<span class="sd">            component.</span>
<span class="sd">        secrets: Secrets to set as environment variables when running on</span>
<span class="sd">            this component.</span>
<span class="sd">        labels: The labels of the component.</span>
<span class="sd">        connector_requirements: The requirements for the connector.</span>
<span class="sd">        connector: The ID of a connector linked to the component.</span>
<span class="sd">        connector_resource_id: The custom resource ID to access through</span>
<span class="sd">            the connector.</span>
<span class="sd">        *args: Additional positional arguments.</span>
<span class="sd">        **kwargs: Additional keyword arguments.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If a secret reference is passed as name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">secret_utils</span><span class="o">.</span><span class="n">is_secret_reference</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Passing the `name` attribute of a stack component as a &quot;</span>
            <span class="s2">&quot;secret reference is not allowed.&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">flavor</span> <span class="o">=</span> <span class="n">flavor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">user</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">created</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">updated</span> <span class="o">=</span> <span class="n">updated</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">environment</span> <span class="o">=</span> <span class="n">environment</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">secrets</span> <span class="o">=</span> <span class="n">secrets</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">connector_requirements</span> <span class="o">=</span> <span class="n">connector_requirements</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">connector</span> <span class="o">=</span> <span class="n">connector</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">connector_resource_id</span> <span class="o">=</span> <span class="n">connector_resource_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_connector_instance</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ServiceConnector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">





<h7 id="zenml.integrations.skypilot.orchestrators.SkypilotBaseOrchestrator-attributes">Attributes</h7>

<div class="doc doc-object doc-attribute">



<h8 id="zenml.integrations.skypilot.orchestrators.SkypilotBaseOrchestrator.cloud" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cloud</span><span class="p">:</span> <span class="n">sky</span><span class="o">.</span><span class="n">clouds</span><span class="o">.</span><span class="n">Cloud</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

        <p>The type of sky cloud to use.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="sky.clouds.Cloud">Cloud</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>sky.clouds.Cloud</code> instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h8 id="zenml.integrations.skypilot.orchestrators.SkypilotBaseOrchestrator.config" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">config</span><span class="p">:</span> <span class="n">SkypilotBaseOrchestratorConfig</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

        <p>Returns the <code>SkypilotBaseOrchestratorConfig</code> config.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="SkypilotBaseOrchestratorConfig(warn_about_plain_text_secrets: bool = False, **kwargs: Any) (zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorConfig)" href="#zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorConfig">SkypilotBaseOrchestratorConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The configuration.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h8 id="zenml.integrations.skypilot.orchestrators.SkypilotBaseOrchestrator.validator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StackValidator</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

        <p>Validates the stack.</p>
<p>In the remote case, checks that the stack contains a container registry,
image builder and only remote components.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="StackValidator(required_components: Optional[AbstractSet[StackComponentType]] = None, custom_validation_function: Optional[Callable[[Stack], Tuple[bool, str]]] = None) (zenml.stack.StackValidator)" href="../core_code_docs/core-stack.html#zenml.stack.StackValidator">StackValidator</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>StackValidator</code> instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>


<h7 id="zenml.integrations.skypilot.orchestrators.SkypilotBaseOrchestrator-functions">Functions</h7>

<div class="doc doc-object doc-function">


<h8 id="zenml.integrations.skypilot.orchestrators.SkypilotBaseOrchestrator.get_orchestrator_run_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_orchestrator_run_id</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h8>


    <div class="doc doc-contents ">

        <p>Returns the active orchestrator run id.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the environment variable specifying the run id
is not set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The orchestrator run id.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/orchestrators/skypilot_base_vm_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_orchestrator_run_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the active orchestrator run id.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the environment variable specifying the run id</span>
<span class="sd">            is not set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The orchestrator run id.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">ENV_ZENML_SKYPILOT_ORCHESTRATOR_RUN_ID</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Unable to read run id from environment variable &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ENV_ZENML_SKYPILOT_ORCHESTRATOR_RUN_ID</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h8 id="zenml.integrations.skypilot.orchestrators.SkypilotBaseOrchestrator.prepare_environment_variable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepare_environment_variable</span><span class="p">(</span><span class="nb">set</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h8>


    <div class="doc doc-contents ">

        <p>Set up Environment variables that are required for the orchestrator.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>set</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to set the environment variables or not.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/orchestrators/skypilot_base_vm_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">prepare_environment_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set up Environment variables that are required for the orchestrator.</span>

<span class="sd">    Args:</span>
<span class="sd">        set: Whether to set the environment variables or not.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h8 id="zenml.integrations.skypilot.orchestrators.SkypilotBaseOrchestrator.setup_credentials" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">setup_credentials</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h8>


    <div class="doc doc-contents ">

        <p>Set up credentials for the orchestrator.</p>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/orchestrators/skypilot_base_vm_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">setup_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set up credentials for the orchestrator.&quot;&quot;&quot;</span>
    <span class="n">connector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connector</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">connector</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="n">connector</span><span class="o">.</span><span class="n">configure_local_client</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h8 id="zenml.integrations.skypilot.orchestrators.SkypilotBaseOrchestrator.submit_pipeline" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">submit_pipeline</span><span class="p">(</span><span class="n">snapshot</span><span class="p">:</span> <span class="n">PipelineSnapshotResponse</span><span class="p">,</span> <span class="n">stack</span><span class="p">:</span> <span class="n">Stack</span><span class="p">,</span> <span class="n">base_environment</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">step_environments</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span> <span class="n">placeholder_run</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PipelineRunResponse</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SubmissionResult</span><span class="p">]</span></code>

</h8>


    <div class="doc doc-contents ">

        <p>Submits a pipeline to the orchestrator.</p>
<p>This method should only submit the pipeline and not wait for it to
complete. If the orchestrator is configured to wait for the pipeline run
to complete, a function that waits for the pipeline run to complete can
be passed as part of the submission result.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>snapshot</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PipelineSnapshotResponse (zenml.models.PipelineSnapshotResponse)" href="../core_code_docs/core-models.html#zenml.models.PipelineSnapshotResponse">PipelineSnapshotResponse</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pipeline snapshot to submit.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stack</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Stack(id: UUID, name: str, *, environment: Optional[Dict[str, str]] = None, secrets: Optional[List[UUID]] = None, orchestrator: BaseOrchestrator, artifact_store: BaseArtifactStore, container_registry: Optional[BaseContainerRegistry] = None, step_operator: Optional[BaseStepOperator] = None, feature_store: Optional[BaseFeatureStore] = None, model_deployer: Optional[BaseModelDeployer] = None, experiment_tracker: Optional[BaseExperimentTracker] = None, alerter: Optional[BaseAlerter] = None, annotator: Optional[BaseAnnotator] = None, data_validator: Optional[BaseDataValidator] = None, image_builder: Optional[BaseImageBuilder] = None, model_registry: Optional[BaseModelRegistry] = None, deployer: Optional[BaseDeployer] = None) (zenml.stack.Stack)" href="../core_code_docs/core-stack.html#zenml.stack.Stack">Stack</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The stack the pipeline will run on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base_environment</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base environment shared by all steps. This should
be set if your orchestrator for example runs one container that
is responsible for starting all the steps.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>step_environments</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Environment variables to set when executing
specific steps.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>placeholder_run</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="PipelineRunResponse (zenml.models.PipelineRunResponse)" href="../core_code_docs/core-models.html#zenml.models.PipelineRunResponse">PipelineRunResponse</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An optional placeholder run for the snapshot.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the pipeline run fails.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the code is running in a notebook.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="SubmissionResult(wait_for_completion: Optional[Callable[[], None]] = None, metadata: Optional[Dict[str, MetadataType]] = None) (zenml.orchestrators.SubmissionResult)" href="../core_code_docs/core-orchestrators.html#zenml.orchestrators.SubmissionResult">SubmissionResult</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional submission result.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/orchestrators/skypilot_base_vm_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">submit_pipeline</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">snapshot</span><span class="p">:</span> <span class="s2">&quot;PipelineSnapshotResponse&quot;</span><span class="p">,</span>
    <span class="n">stack</span><span class="p">:</span> <span class="s2">&quot;Stack&quot;</span><span class="p">,</span>
    <span class="n">base_environment</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">step_environments</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
    <span class="n">placeholder_run</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;PipelineRunResponse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SubmissionResult</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Submits a pipeline to the orchestrator.</span>

<span class="sd">    This method should only submit the pipeline and not wait for it to</span>
<span class="sd">    complete. If the orchestrator is configured to wait for the pipeline run</span>
<span class="sd">    to complete, a function that waits for the pipeline run to complete can</span>
<span class="sd">    be passed as part of the submission result.</span>

<span class="sd">    Args:</span>
<span class="sd">        snapshot: The pipeline snapshot to submit.</span>
<span class="sd">        stack: The stack the pipeline will run on.</span>
<span class="sd">        base_environment: Base environment shared by all steps. This should</span>
<span class="sd">            be set if your orchestrator for example runs one container that</span>
<span class="sd">            is responsible for starting all the steps.</span>
<span class="sd">        step_environments: Environment variables to set when executing</span>
<span class="sd">            specific steps.</span>
<span class="sd">        placeholder_run: An optional placeholder run for the snapshot.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If the pipeline run fails.</span>
<span class="sd">        RuntimeError: If the code is running in a notebook.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional submission result.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># First check whether the code is running in a notebook.</span>
    <span class="k">if</span> <span class="n">Environment</span><span class="o">.</span><span class="n">in_notebook</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;The Skypilot orchestrator cannot run pipelines in a notebook &quot;</span>
            <span class="s2">&quot;environment. The reason is that it is non-trivial to create &quot;</span>
            <span class="s2">&quot;a Docker image of a notebook. Please consider refactoring &quot;</span>
            <span class="s2">&quot;your notebook cells into separate scripts in a Python module &quot;</span>
            <span class="s2">&quot;and run the code outside of a notebook when using this &quot;</span>
            <span class="s2">&quot;orchestrator.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">schedule</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Skypilot Orchestrator currently does not support the &quot;</span>
            <span class="s2">&quot;use of schedules. The `schedule` will be ignored &quot;</span>
            <span class="s2">&quot;and the pipeline will be run immediately.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Set up some variables for configuration</span>
    <span class="n">orchestrator_run_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid4</span><span class="p">())</span>
    <span class="n">base_environment</span><span class="p">[</span><span class="n">ENV_ZENML_SKYPILOT_ORCHESTRATOR_RUN_ID</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">orchestrator_run_id</span>
    <span class="p">)</span>

    <span class="n">settings</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
        <span class="n">SkypilotBaseOrchestratorSettings</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_settings</span><span class="p">(</span><span class="n">snapshot</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="n">pipeline_name</span> <span class="o">=</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">name</span>
    <span class="n">orchestrator_run_name</span> <span class="o">=</span> <span class="n">get_orchestrator_run_name</span><span class="p">(</span><span class="n">pipeline_name</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">stack</span><span class="o">.</span><span class="n">container_registry</span>

    <span class="c1"># Get Docker image for the orchestrator pod</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_image</span><span class="p">(</span><span class="n">snapshot</span><span class="o">=</span><span class="n">snapshot</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="c1"># If no generic pipeline image exists (which means all steps have</span>
        <span class="c1"># custom builds) we use a random step image as all of them include</span>
        <span class="c1"># dependencies for the active stack</span>
        <span class="n">pipeline_step_name</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">snapshot</span><span class="o">.</span><span class="n">step_configurations</span><span class="p">))</span>
        <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_image</span><span class="p">(</span>
            <span class="n">snapshot</span><span class="o">=</span><span class="n">snapshot</span><span class="p">,</span> <span class="n">step_name</span><span class="o">=</span><span class="n">pipeline_step_name</span>
        <span class="p">)</span>

    <span class="n">different_settings_found</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">disable_step_based_settings</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">step_configurations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">step_settings</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">SkypilotBaseOrchestratorSettings</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_settings</span><span class="p">(</span><span class="n">step</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">step_settings</span> <span class="o">!=</span> <span class="n">settings</span><span class="p">:</span>
                <span class="n">different_settings_found</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="s2">&quot;At least one step has different settings than the &quot;</span>
                    <span class="s2">&quot;pipeline. The step with different settings will be &quot;</span>
                    <span class="s2">&quot;run in a separate VM.</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="s2">&quot;You can configure the orchestrator to disable this &quot;</span>
                    <span class="s2">&quot;behavior by updating the `disable_step_based_settings` &quot;</span>
                    <span class="s2">&quot;in your orchestrator configuration &quot;</span>
                    <span class="s2">&quot;by running the following command: &quot;</span>
                    <span class="s2">&quot;`zenml orchestrator update --disable-step-based-settings=True`&quot;</span>
                <span class="p">)</span>
                <span class="k">break</span>

    <span class="c1"># Decide which configuration to use based on whether different settings were found</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">disable_step_based_settings</span>
        <span class="ow">and</span> <span class="n">different_settings_found</span>
    <span class="p">):</span>
        <span class="c1"># Run each step in a separate VM using SkypilotOrchestratorEntrypointConfiguration</span>
        <span class="n">command</span> <span class="o">=</span> <span class="n">SkypilotOrchestratorEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_command</span><span class="p">()</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">SkypilotOrchestratorEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_arguments</span><span class="p">(</span>
            <span class="n">run_name</span><span class="o">=</span><span class="n">orchestrator_run_name</span><span class="p">,</span>
            <span class="n">snapshot_id</span><span class="o">=</span><span class="n">snapshot</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Run the entire pipeline in one VM using PipelineEntrypointConfiguration</span>
        <span class="n">command</span> <span class="o">=</span> <span class="n">PipelineEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_command</span><span class="p">()</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">PipelineEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_arguments</span><span class="p">(</span>
            <span class="n">snapshot_id</span><span class="o">=</span><span class="n">snapshot</span><span class="o">.</span><span class="n">id</span>
        <span class="p">)</span>

    <span class="n">entrypoint_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
    <span class="n">arguments_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="n">task_envs</span> <span class="o">=</span> <span class="n">base_environment</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Set up credentials</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setup_credentials</span><span class="p">()</span>

    <span class="c1"># Prepare Docker setup</span>
    <span class="n">setup</span><span class="p">,</span> <span class="n">docker_creds_envs</span> <span class="o">=</span> <span class="n">prepare_docker_setup</span><span class="p">(</span>
        <span class="n">container_registry_uri</span><span class="o">=</span><span class="n">stack</span><span class="o">.</span><span class="n">container_registry</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">uri</span><span class="p">,</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">stack</span><span class="o">.</span><span class="n">container_registry</span><span class="o">.</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">use_sudo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Base orchestrator uses sudo</span>
    <span class="p">)</span>

    <span class="c1"># Update task_envs with Docker credentials</span>
    <span class="k">if</span> <span class="n">docker_creds_envs</span><span class="p">:</span>
        <span class="n">task_envs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">docker_creds_envs</span><span class="p">)</span>

    <span class="c1"># Run the entire pipeline</span>

    <span class="c1"># Set the service connector AWS profile ENV variable</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prepare_environment_variable</span><span class="p">(</span><span class="nb">set</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cloud</span><span class="p">,</span> <span class="n">sky</span><span class="o">.</span><span class="n">clouds</span><span class="o">.</span><span class="n">Kubernetes</span><span class="p">):</span>
            <span class="n">run_command</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="se">{{</span><span class="s2">VIRTUAL_ENV:+$VIRTUAL_ENV/bin/</span><span class="se">}}</span><span class="si">{</span><span class="n">entrypoint_str</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">arguments_str</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">setup</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">down</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">idle_minutes_to_autostop</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">run_command</span> <span class="o">=</span> <span class="n">create_docker_run_command</span><span class="p">(</span>
                <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
                <span class="n">entrypoint_str</span><span class="o">=</span><span class="n">entrypoint_str</span><span class="p">,</span>
                <span class="n">arguments_str</span><span class="o">=</span><span class="n">arguments_str</span><span class="p">,</span>
                <span class="n">environment</span><span class="o">=</span><span class="n">task_envs</span><span class="p">,</span>
                <span class="n">docker_run_args</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">docker_run_args</span><span class="p">,</span>
                <span class="n">use_sudo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Base orchestrator uses sudo</span>
            <span class="p">)</span>
            <span class="n">down</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">down</span>
            <span class="n">idle_minutes_to_autostop</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">idle_minutes_to_autostop</span>

        <span class="c1"># Create the Task with all parameters and task settings</span>
        <span class="n">task_kwargs</span> <span class="o">=</span> <span class="n">prepare_task_kwargs</span><span class="p">(</span>
            <span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
            <span class="n">run_command</span><span class="o">=</span><span class="n">run_command</span><span class="p">,</span>
            <span class="n">setup</span><span class="o">=</span><span class="n">setup</span><span class="p">,</span>
            <span class="n">task_envs</span><span class="o">=</span><span class="n">task_envs</span><span class="p">,</span>
            <span class="n">task_name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">orchestrator_run_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">task</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">Task</span><span class="p">(</span><span class="o">**</span><span class="n">task_kwargs</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running run: </span><span class="si">{</span><span class="n">run_command</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Set resources with all parameters and resource settings</span>
        <span class="n">resources_kwargs</span> <span class="o">=</span> <span class="n">prepare_resources_kwargs</span><span class="p">(</span>
            <span class="n">cloud</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cloud</span><span class="p">,</span>
            <span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
            <span class="n">default_instance_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_INSTANCE_TYPE</span><span class="p">,</span>
            <span class="n">kubernetes_image</span><span class="o">=</span><span class="n">image</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cloud</span><span class="p">,</span> <span class="n">sky</span><span class="o">.</span><span class="n">clouds</span><span class="o">.</span><span class="n">Kubernetes</span><span class="p">)</span>
            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">task</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">set_resources</span><span class="p">(</span><span class="n">sky</span><span class="o">.</span><span class="n">Resources</span><span class="p">(</span><span class="o">**</span><span class="n">resources_kwargs</span><span class="p">))</span>

        <span class="n">launch_new_cluster</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span><span class="p">:</span>
            <span class="n">status_request_id</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">status</span><span class="p">(</span>
                <span class="n">refresh</span><span class="o">=</span><span class="n">StatusRefreshMode</span><span class="o">.</span><span class="n">AUTO</span><span class="p">,</span>
                <span class="n">cluster_names</span><span class="o">=</span><span class="p">[</span><span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="n">cluster_info</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">stream_and_get</span><span class="p">(</span><span class="n">status_request_id</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">cluster_info</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Found existing cluster </span><span class="si">{</span><span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span><span class="si">}</span><span class="s2">. Reusing...&quot;</span>
                <span class="p">)</span>
                <span class="n">launch_new_cluster</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Cluster </span><span class="si">{</span><span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span><span class="si">}</span><span class="s2"> not found. Launching a new one...&quot;</span>
                <span class="p">)</span>
                <span class="n">cluster_name</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cluster_name</span> <span class="o">=</span> <span class="n">sanitize_cluster_name</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">orchestrator_run_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No cluster name provided. Launching a new cluster with name </span><span class="si">{</span><span class="n">cluster_name</span><span class="si">}</span><span class="s2">...&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">launch_new_cluster</span><span class="p">:</span>
            <span class="c1"># Prepare launch parameters with additional launch settings</span>
            <span class="n">launch_kwargs</span> <span class="o">=</span> <span class="n">prepare_launch_kwargs</span><span class="p">(</span>
                <span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
                <span class="n">down</span><span class="o">=</span><span class="n">down</span><span class="p">,</span>
                <span class="n">idle_minutes_to_autostop</span><span class="o">=</span><span class="n">idle_minutes_to_autostop</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Launching the task on a new cluster: </span><span class="si">{</span><span class="n">cluster_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">launch_job_id</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span>
                <span class="n">task</span><span class="p">,</span>
                <span class="n">cluster_name</span><span class="p">,</span>
                <span class="o">**</span><span class="n">launch_kwargs</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">sky_job_get</span><span class="p">(</span>
                <span class="n">launch_job_id</span><span class="p">,</span> <span class="n">settings</span><span class="o">.</span><span class="n">stream_logs</span><span class="p">,</span> <span class="n">cluster_name</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Prepare exec parameters with additional launch settings</span>
            <span class="n">exec_kwargs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="n">down</span><span class="p">,</span>
                <span class="s2">&quot;backend&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="o">**</span><span class="n">settings</span><span class="o">.</span><span class="n">launch_settings</span><span class="p">,</span>  <span class="c1"># Can reuse same settings for exec</span>
            <span class="p">}</span>

            <span class="c1"># Remove None values to avoid overriding SkyPilot defaults</span>
            <span class="n">exec_kwargs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">exec_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="p">}</span>

            <span class="c1"># Make sure the cluster is up</span>
            <span class="n">start_request_id</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">start</span><span class="p">(</span>
                <span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span><span class="p">,</span>
                <span class="n">down</span><span class="o">=</span><span class="n">down</span><span class="p">,</span>
                <span class="n">idle_minutes_to_autostop</span><span class="o">=</span><span class="n">idle_minutes_to_autostop</span><span class="p">,</span>
                <span class="n">retry_until_up</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">retry_until_up</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">sky</span><span class="o">.</span><span class="n">stream_and_get</span><span class="p">(</span><span class="n">start_request_id</span><span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Executing the task on the cluster: </span><span class="si">{</span><span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">exec_job_id</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
                <span class="n">task</span><span class="p">,</span>
                <span class="n">cluster_name</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span><span class="p">,</span>
                <span class="o">**</span><span class="n">exec_kwargs</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">assert</span> <span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="n">sky_job_get</span><span class="p">(</span>
                <span class="n">exec_job_id</span><span class="p">,</span> <span class="n">settings</span><span class="o">.</span><span class="n">stream_logs</span><span class="p">,</span> <span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span>
            <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pipeline run failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>

    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># Unset the service connector AWS profile ENV variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare_environment_variable</span><span class="p">(</span><span class="nb">set</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<h5 id="zenml.integrations.skypilot.orchestrators-modules">Modules</h5>

<div class="doc doc-object doc-module">



<h6 id="zenml.integrations.skypilot.orchestrators.skypilot_base_vm_orchestrator" class="doc doc-heading">
            <code>skypilot_base_vm_orchestrator</code>


</h6>

    <div class="doc doc-contents ">

        <p>Implementation of the Skypilot base VM orchestrator.</p>










  <div class="doc doc-children">







<h7 id="zenml.integrations.skypilot.orchestrators.skypilot_base_vm_orchestrator-classes">Classes</h7>

<div class="doc doc-object doc-class">



<h8 id="zenml.integrations.skypilot.orchestrators.skypilot_base_vm_orchestrator.SkypilotBaseOrchestrator" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">SkypilotBaseOrchestrator</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="n">UUID</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">StackComponentConfig</span><span class="p">,</span> <span class="n">flavor</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="n">StackComponentType</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UUID</span><span class="p">],</span> <span class="n">created</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">updated</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">environment</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">secrets</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">UUID</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">connector_requirements</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ServiceConnectorRequirements</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">connector</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UUID</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">connector_resource_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span></code>

</h8>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ContainerizedOrchestrator(name: str, id: UUID, config: StackComponentConfig, flavor: str, type: StackComponentType, user: Optional[UUID], created: datetime, updated: datetime, environment: Optional[Dict[str, str]] = None, secrets: Optional[List[UUID]] = None, labels: Optional[Dict[str, Any]] = None, connector_requirements: Optional[ServiceConnectorRequirements] = None, connector: Optional[UUID] = None, connector_resource_id: Optional[str] = None, *args: Any, **kwargs: Any) (zenml.orchestrators.ContainerizedOrchestrator)" href="../core_code_docs/core-orchestrators.html#zenml.orchestrators.ContainerizedOrchestrator">ContainerizedOrchestrator</a></code></p>


        <p>Base class for Orchestrator responsible for running pipelines remotely in a VM.</p>
<p>This orchestrator does not support running on a schedule.</p>








                  <details class="quote">
                    <summary>Source code in <code>src/zenml/stack/stack_component.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">UUID</span><span class="p">,</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">StackComponentConfig</span><span class="p">,</span>
    <span class="n">flavor</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">StackComponentType</span><span class="p">,</span>
    <span class="n">user</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UUID</span><span class="p">],</span>
    <span class="n">created</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="n">updated</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="n">environment</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">secrets</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">UUID</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">connector_requirements</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ServiceConnectorRequirements</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">connector</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UUID</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">connector_resource_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes a StackComponent.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: The name of the component.</span>
<span class="sd">        id: The unique ID of the component.</span>
<span class="sd">        config: The config of the component.</span>
<span class="sd">        flavor: The flavor of the component.</span>
<span class="sd">        type: The type of the component.</span>
<span class="sd">        user: The ID of the user who created the component.</span>
<span class="sd">        created: The creation time of the component.</span>
<span class="sd">        updated: The last update time of the component.</span>
<span class="sd">        environment: Environment variables to set when running on this</span>
<span class="sd">            component.</span>
<span class="sd">        secrets: Secrets to set as environment variables when running on</span>
<span class="sd">            this component.</span>
<span class="sd">        labels: The labels of the component.</span>
<span class="sd">        connector_requirements: The requirements for the connector.</span>
<span class="sd">        connector: The ID of a connector linked to the component.</span>
<span class="sd">        connector_resource_id: The custom resource ID to access through</span>
<span class="sd">            the connector.</span>
<span class="sd">        *args: Additional positional arguments.</span>
<span class="sd">        **kwargs: Additional keyword arguments.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If a secret reference is passed as name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">secret_utils</span><span class="o">.</span><span class="n">is_secret_reference</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Passing the `name` attribute of a stack component as a &quot;</span>
            <span class="s2">&quot;secret reference is not allowed.&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">flavor</span> <span class="o">=</span> <span class="n">flavor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">user</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">created</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">updated</span> <span class="o">=</span> <span class="n">updated</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">environment</span> <span class="o">=</span> <span class="n">environment</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">secrets</span> <span class="o">=</span> <span class="n">secrets</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">connector_requirements</span> <span class="o">=</span> <span class="n">connector_requirements</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">connector</span> <span class="o">=</span> <span class="n">connector</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">connector_resource_id</span> <span class="o">=</span> <span class="n">connector_resource_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_connector_instance</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ServiceConnector</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">





<h9 id="zenml.integrations.skypilot.orchestrators.skypilot_base_vm_orchestrator.SkypilotBaseOrchestrator-attributes">Attributes</h9>

<div class="doc doc-object doc-attribute">



<h10 id="zenml.integrations.skypilot.orchestrators.skypilot_base_vm_orchestrator.SkypilotBaseOrchestrator.cloud" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cloud</span><span class="p">:</span> <span class="n">sky</span><span class="o">.</span><span class="n">clouds</span><span class="o">.</span><span class="n">Cloud</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h10>


    <div class="doc doc-contents ">

        <p>The type of sky cloud to use.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="sky.clouds.Cloud">Cloud</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>sky.clouds.Cloud</code> instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h10 id="zenml.integrations.skypilot.orchestrators.skypilot_base_vm_orchestrator.SkypilotBaseOrchestrator.config" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">config</span><span class="p">:</span> <span class="n">SkypilotBaseOrchestratorConfig</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h10>


    <div class="doc doc-contents ">

        <p>Returns the <code>SkypilotBaseOrchestratorConfig</code> config.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="SkypilotBaseOrchestratorConfig(warn_about_plain_text_secrets: bool = False, **kwargs: Any) (zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorConfig)" href="#zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorConfig">SkypilotBaseOrchestratorConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The configuration.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h10 id="zenml.integrations.skypilot.orchestrators.skypilot_base_vm_orchestrator.SkypilotBaseOrchestrator.validator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StackValidator</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h10>


    <div class="doc doc-contents ">

        <p>Validates the stack.</p>
<p>In the remote case, checks that the stack contains a container registry,
image builder and only remote components.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="StackValidator(required_components: Optional[AbstractSet[StackComponentType]] = None, custom_validation_function: Optional[Callable[[Stack], Tuple[bool, str]]] = None) (zenml.stack.StackValidator)" href="../core_code_docs/core-stack.html#zenml.stack.StackValidator">StackValidator</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A <code>StackValidator</code> instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>


<h9 id="zenml.integrations.skypilot.orchestrators.skypilot_base_vm_orchestrator.SkypilotBaseOrchestrator-functions">Functions</h9>

<div class="doc doc-object doc-function">


<h10 id="zenml.integrations.skypilot.orchestrators.skypilot_base_vm_orchestrator.SkypilotBaseOrchestrator.get_orchestrator_run_id" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_orchestrator_run_id</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h10>


    <div class="doc doc-contents ">

        <p>Returns the active orchestrator run id.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the environment variable specifying the run id
is not set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The orchestrator run id.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/orchestrators/skypilot_base_vm_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_orchestrator_run_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the active orchestrator run id.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If the environment variable specifying the run id</span>
<span class="sd">            is not set.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The orchestrator run id.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">ENV_ZENML_SKYPILOT_ORCHESTRATOR_RUN_ID</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Unable to read run id from environment variable &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ENV_ZENML_SKYPILOT_ORCHESTRATOR_RUN_ID</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h10 id="zenml.integrations.skypilot.orchestrators.skypilot_base_vm_orchestrator.SkypilotBaseOrchestrator.prepare_environment_variable" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepare_environment_variable</span><span class="p">(</span><span class="nb">set</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h10>


    <div class="doc doc-contents ">

        <p>Set up Environment variables that are required for the orchestrator.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>set</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to set the environment variables or not.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/orchestrators/skypilot_base_vm_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">prepare_environment_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set up Environment variables that are required for the orchestrator.</span>

<span class="sd">    Args:</span>
<span class="sd">        set: Whether to set the environment variables or not.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h10 id="zenml.integrations.skypilot.orchestrators.skypilot_base_vm_orchestrator.SkypilotBaseOrchestrator.setup_credentials" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">setup_credentials</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h10>


    <div class="doc doc-contents ">

        <p>Set up credentials for the orchestrator.</p>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/orchestrators/skypilot_base_vm_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">setup_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set up credentials for the orchestrator.&quot;&quot;&quot;</span>
    <span class="n">connector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connector</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">connector</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="n">connector</span><span class="o">.</span><span class="n">configure_local_client</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h10 id="zenml.integrations.skypilot.orchestrators.skypilot_base_vm_orchestrator.SkypilotBaseOrchestrator.submit_pipeline" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">submit_pipeline</span><span class="p">(</span><span class="n">snapshot</span><span class="p">:</span> <span class="n">PipelineSnapshotResponse</span><span class="p">,</span> <span class="n">stack</span><span class="p">:</span> <span class="n">Stack</span><span class="p">,</span> <span class="n">base_environment</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">step_environments</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span> <span class="n">placeholder_run</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PipelineRunResponse</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SubmissionResult</span><span class="p">]</span></code>

</h10>


    <div class="doc doc-contents ">

        <p>Submits a pipeline to the orchestrator.</p>
<p>This method should only submit the pipeline and not wait for it to
complete. If the orchestrator is configured to wait for the pipeline run
to complete, a function that waits for the pipeline run to complete can
be passed as part of the submission result.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>snapshot</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PipelineSnapshotResponse (zenml.models.PipelineSnapshotResponse)" href="../core_code_docs/core-models.html#zenml.models.PipelineSnapshotResponse">PipelineSnapshotResponse</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The pipeline snapshot to submit.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stack</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Stack(id: UUID, name: str, *, environment: Optional[Dict[str, str]] = None, secrets: Optional[List[UUID]] = None, orchestrator: BaseOrchestrator, artifact_store: BaseArtifactStore, container_registry: Optional[BaseContainerRegistry] = None, step_operator: Optional[BaseStepOperator] = None, feature_store: Optional[BaseFeatureStore] = None, model_deployer: Optional[BaseModelDeployer] = None, experiment_tracker: Optional[BaseExperimentTracker] = None, alerter: Optional[BaseAlerter] = None, annotator: Optional[BaseAnnotator] = None, data_validator: Optional[BaseDataValidator] = None, image_builder: Optional[BaseImageBuilder] = None, model_registry: Optional[BaseModelRegistry] = None, deployer: Optional[BaseDeployer] = None) (zenml.stack.Stack)" href="../core_code_docs/core-stack.html#zenml.stack.Stack">Stack</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The stack the pipeline will run on.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base_environment</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base environment shared by all steps. This should
be set if your orchestrator for example runs one container that
is responsible for starting all the steps.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>step_environments</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Environment variables to set when executing
specific steps.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>placeholder_run</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="PipelineRunResponse (zenml.models.PipelineRunResponse)" href="../core_code_docs/core-models.html#zenml.models.PipelineRunResponse">PipelineRunResponse</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An optional placeholder run for the snapshot.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the pipeline run fails.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the code is running in a notebook.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="SubmissionResult(wait_for_completion: Optional[Callable[[], None]] = None, metadata: Optional[Dict[str, MetadataType]] = None) (zenml.orchestrators.SubmissionResult)" href="../core_code_docs/core-orchestrators.html#zenml.orchestrators.SubmissionResult">SubmissionResult</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional submission result.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/orchestrators/skypilot_base_vm_orchestrator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">submit_pipeline</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">snapshot</span><span class="p">:</span> <span class="s2">&quot;PipelineSnapshotResponse&quot;</span><span class="p">,</span>
    <span class="n">stack</span><span class="p">:</span> <span class="s2">&quot;Stack&quot;</span><span class="p">,</span>
    <span class="n">base_environment</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">step_environments</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
    <span class="n">placeholder_run</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;PipelineRunResponse&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SubmissionResult</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Submits a pipeline to the orchestrator.</span>

<span class="sd">    This method should only submit the pipeline and not wait for it to</span>
<span class="sd">    complete. If the orchestrator is configured to wait for the pipeline run</span>
<span class="sd">    to complete, a function that waits for the pipeline run to complete can</span>
<span class="sd">    be passed as part of the submission result.</span>

<span class="sd">    Args:</span>
<span class="sd">        snapshot: The pipeline snapshot to submit.</span>
<span class="sd">        stack: The stack the pipeline will run on.</span>
<span class="sd">        base_environment: Base environment shared by all steps. This should</span>
<span class="sd">            be set if your orchestrator for example runs one container that</span>
<span class="sd">            is responsible for starting all the steps.</span>
<span class="sd">        step_environments: Environment variables to set when executing</span>
<span class="sd">            specific steps.</span>
<span class="sd">        placeholder_run: An optional placeholder run for the snapshot.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If the pipeline run fails.</span>
<span class="sd">        RuntimeError: If the code is running in a notebook.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional submission result.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># First check whether the code is running in a notebook.</span>
    <span class="k">if</span> <span class="n">Environment</span><span class="o">.</span><span class="n">in_notebook</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;The Skypilot orchestrator cannot run pipelines in a notebook &quot;</span>
            <span class="s2">&quot;environment. The reason is that it is non-trivial to create &quot;</span>
            <span class="s2">&quot;a Docker image of a notebook. Please consider refactoring &quot;</span>
            <span class="s2">&quot;your notebook cells into separate scripts in a Python module &quot;</span>
            <span class="s2">&quot;and run the code outside of a notebook when using this &quot;</span>
            <span class="s2">&quot;orchestrator.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">schedule</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Skypilot Orchestrator currently does not support the &quot;</span>
            <span class="s2">&quot;use of schedules. The `schedule` will be ignored &quot;</span>
            <span class="s2">&quot;and the pipeline will be run immediately.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Set up some variables for configuration</span>
    <span class="n">orchestrator_run_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid4</span><span class="p">())</span>
    <span class="n">base_environment</span><span class="p">[</span><span class="n">ENV_ZENML_SKYPILOT_ORCHESTRATOR_RUN_ID</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">orchestrator_run_id</span>
    <span class="p">)</span>

    <span class="n">settings</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
        <span class="n">SkypilotBaseOrchestratorSettings</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_settings</span><span class="p">(</span><span class="n">snapshot</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="n">pipeline_name</span> <span class="o">=</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">pipeline_configuration</span><span class="o">.</span><span class="n">name</span>
    <span class="n">orchestrator_run_name</span> <span class="o">=</span> <span class="n">get_orchestrator_run_name</span><span class="p">(</span><span class="n">pipeline_name</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">stack</span><span class="o">.</span><span class="n">container_registry</span>

    <span class="c1"># Get Docker image for the orchestrator pod</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_image</span><span class="p">(</span><span class="n">snapshot</span><span class="o">=</span><span class="n">snapshot</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="c1"># If no generic pipeline image exists (which means all steps have</span>
        <span class="c1"># custom builds) we use a random step image as all of them include</span>
        <span class="c1"># dependencies for the active stack</span>
        <span class="n">pipeline_step_name</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">snapshot</span><span class="o">.</span><span class="n">step_configurations</span><span class="p">))</span>
        <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_image</span><span class="p">(</span>
            <span class="n">snapshot</span><span class="o">=</span><span class="n">snapshot</span><span class="p">,</span> <span class="n">step_name</span><span class="o">=</span><span class="n">pipeline_step_name</span>
        <span class="p">)</span>

    <span class="n">different_settings_found</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">disable_step_based_settings</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">step_configurations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">step_settings</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">SkypilotBaseOrchestratorSettings</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_settings</span><span class="p">(</span><span class="n">step</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">step_settings</span> <span class="o">!=</span> <span class="n">settings</span><span class="p">:</span>
                <span class="n">different_settings_found</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="s2">&quot;At least one step has different settings than the &quot;</span>
                    <span class="s2">&quot;pipeline. The step with different settings will be &quot;</span>
                    <span class="s2">&quot;run in a separate VM.</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="s2">&quot;You can configure the orchestrator to disable this &quot;</span>
                    <span class="s2">&quot;behavior by updating the `disable_step_based_settings` &quot;</span>
                    <span class="s2">&quot;in your orchestrator configuration &quot;</span>
                    <span class="s2">&quot;by running the following command: &quot;</span>
                    <span class="s2">&quot;`zenml orchestrator update --disable-step-based-settings=True`&quot;</span>
                <span class="p">)</span>
                <span class="k">break</span>

    <span class="c1"># Decide which configuration to use based on whether different settings were found</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">disable_step_based_settings</span>
        <span class="ow">and</span> <span class="n">different_settings_found</span>
    <span class="p">):</span>
        <span class="c1"># Run each step in a separate VM using SkypilotOrchestratorEntrypointConfiguration</span>
        <span class="n">command</span> <span class="o">=</span> <span class="n">SkypilotOrchestratorEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_command</span><span class="p">()</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">SkypilotOrchestratorEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_arguments</span><span class="p">(</span>
            <span class="n">run_name</span><span class="o">=</span><span class="n">orchestrator_run_name</span><span class="p">,</span>
            <span class="n">snapshot_id</span><span class="o">=</span><span class="n">snapshot</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Run the entire pipeline in one VM using PipelineEntrypointConfiguration</span>
        <span class="n">command</span> <span class="o">=</span> <span class="n">PipelineEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_command</span><span class="p">()</span>
        <span class="n">args</span> <span class="o">=</span> <span class="n">PipelineEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_arguments</span><span class="p">(</span>
            <span class="n">snapshot_id</span><span class="o">=</span><span class="n">snapshot</span><span class="o">.</span><span class="n">id</span>
        <span class="p">)</span>

    <span class="n">entrypoint_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
    <span class="n">arguments_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="n">task_envs</span> <span class="o">=</span> <span class="n">base_environment</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Set up credentials</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setup_credentials</span><span class="p">()</span>

    <span class="c1"># Prepare Docker setup</span>
    <span class="n">setup</span><span class="p">,</span> <span class="n">docker_creds_envs</span> <span class="o">=</span> <span class="n">prepare_docker_setup</span><span class="p">(</span>
        <span class="n">container_registry_uri</span><span class="o">=</span><span class="n">stack</span><span class="o">.</span><span class="n">container_registry</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">uri</span><span class="p">,</span>
        <span class="n">credentials</span><span class="o">=</span><span class="n">stack</span><span class="o">.</span><span class="n">container_registry</span><span class="o">.</span><span class="n">credentials</span><span class="p">,</span>
        <span class="n">use_sudo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Base orchestrator uses sudo</span>
    <span class="p">)</span>

    <span class="c1"># Update task_envs with Docker credentials</span>
    <span class="k">if</span> <span class="n">docker_creds_envs</span><span class="p">:</span>
        <span class="n">task_envs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">docker_creds_envs</span><span class="p">)</span>

    <span class="c1"># Run the entire pipeline</span>

    <span class="c1"># Set the service connector AWS profile ENV variable</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prepare_environment_variable</span><span class="p">(</span><span class="nb">set</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cloud</span><span class="p">,</span> <span class="n">sky</span><span class="o">.</span><span class="n">clouds</span><span class="o">.</span><span class="n">Kubernetes</span><span class="p">):</span>
            <span class="n">run_command</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="se">{{</span><span class="s2">VIRTUAL_ENV:+$VIRTUAL_ENV/bin/</span><span class="se">}}</span><span class="si">{</span><span class="n">entrypoint_str</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">arguments_str</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">setup</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">down</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">idle_minutes_to_autostop</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">run_command</span> <span class="o">=</span> <span class="n">create_docker_run_command</span><span class="p">(</span>
                <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
                <span class="n">entrypoint_str</span><span class="o">=</span><span class="n">entrypoint_str</span><span class="p">,</span>
                <span class="n">arguments_str</span><span class="o">=</span><span class="n">arguments_str</span><span class="p">,</span>
                <span class="n">environment</span><span class="o">=</span><span class="n">task_envs</span><span class="p">,</span>
                <span class="n">docker_run_args</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">docker_run_args</span><span class="p">,</span>
                <span class="n">use_sudo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Base orchestrator uses sudo</span>
            <span class="p">)</span>
            <span class="n">down</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">down</span>
            <span class="n">idle_minutes_to_autostop</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">idle_minutes_to_autostop</span>

        <span class="c1"># Create the Task with all parameters and task settings</span>
        <span class="n">task_kwargs</span> <span class="o">=</span> <span class="n">prepare_task_kwargs</span><span class="p">(</span>
            <span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
            <span class="n">run_command</span><span class="o">=</span><span class="n">run_command</span><span class="p">,</span>
            <span class="n">setup</span><span class="o">=</span><span class="n">setup</span><span class="p">,</span>
            <span class="n">task_envs</span><span class="o">=</span><span class="n">task_envs</span><span class="p">,</span>
            <span class="n">task_name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">orchestrator_run_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">task</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">Task</span><span class="p">(</span><span class="o">**</span><span class="n">task_kwargs</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running run: </span><span class="si">{</span><span class="n">run_command</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Set resources with all parameters and resource settings</span>
        <span class="n">resources_kwargs</span> <span class="o">=</span> <span class="n">prepare_resources_kwargs</span><span class="p">(</span>
            <span class="n">cloud</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cloud</span><span class="p">,</span>
            <span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
            <span class="n">default_instance_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_INSTANCE_TYPE</span><span class="p">,</span>
            <span class="n">kubernetes_image</span><span class="o">=</span><span class="n">image</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cloud</span><span class="p">,</span> <span class="n">sky</span><span class="o">.</span><span class="n">clouds</span><span class="o">.</span><span class="n">Kubernetes</span><span class="p">)</span>
            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">task</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">set_resources</span><span class="p">(</span><span class="n">sky</span><span class="o">.</span><span class="n">Resources</span><span class="p">(</span><span class="o">**</span><span class="n">resources_kwargs</span><span class="p">))</span>

        <span class="n">launch_new_cluster</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span><span class="p">:</span>
            <span class="n">status_request_id</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">status</span><span class="p">(</span>
                <span class="n">refresh</span><span class="o">=</span><span class="n">StatusRefreshMode</span><span class="o">.</span><span class="n">AUTO</span><span class="p">,</span>
                <span class="n">cluster_names</span><span class="o">=</span><span class="p">[</span><span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="n">cluster_info</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">stream_and_get</span><span class="p">(</span><span class="n">status_request_id</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">cluster_info</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Found existing cluster </span><span class="si">{</span><span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span><span class="si">}</span><span class="s2">. Reusing...&quot;</span>
                <span class="p">)</span>
                <span class="n">launch_new_cluster</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Cluster </span><span class="si">{</span><span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span><span class="si">}</span><span class="s2"> not found. Launching a new one...&quot;</span>
                <span class="p">)</span>
                <span class="n">cluster_name</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cluster_name</span> <span class="o">=</span> <span class="n">sanitize_cluster_name</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">orchestrator_run_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;No cluster name provided. Launching a new cluster with name </span><span class="si">{</span><span class="n">cluster_name</span><span class="si">}</span><span class="s2">...&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">launch_new_cluster</span><span class="p">:</span>
            <span class="c1"># Prepare launch parameters with additional launch settings</span>
            <span class="n">launch_kwargs</span> <span class="o">=</span> <span class="n">prepare_launch_kwargs</span><span class="p">(</span>
                <span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
                <span class="n">down</span><span class="o">=</span><span class="n">down</span><span class="p">,</span>
                <span class="n">idle_minutes_to_autostop</span><span class="o">=</span><span class="n">idle_minutes_to_autostop</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Launching the task on a new cluster: </span><span class="si">{</span><span class="n">cluster_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">launch_job_id</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span>
                <span class="n">task</span><span class="p">,</span>
                <span class="n">cluster_name</span><span class="p">,</span>
                <span class="o">**</span><span class="n">launch_kwargs</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">sky_job_get</span><span class="p">(</span>
                <span class="n">launch_job_id</span><span class="p">,</span> <span class="n">settings</span><span class="o">.</span><span class="n">stream_logs</span><span class="p">,</span> <span class="n">cluster_name</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Prepare exec parameters with additional launch settings</span>
            <span class="n">exec_kwargs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="n">down</span><span class="p">,</span>
                <span class="s2">&quot;backend&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="o">**</span><span class="n">settings</span><span class="o">.</span><span class="n">launch_settings</span><span class="p">,</span>  <span class="c1"># Can reuse same settings for exec</span>
            <span class="p">}</span>

            <span class="c1"># Remove None values to avoid overriding SkyPilot defaults</span>
            <span class="n">exec_kwargs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">exec_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="p">}</span>

            <span class="c1"># Make sure the cluster is up</span>
            <span class="n">start_request_id</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">start</span><span class="p">(</span>
                <span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span><span class="p">,</span>
                <span class="n">down</span><span class="o">=</span><span class="n">down</span><span class="p">,</span>
                <span class="n">idle_minutes_to_autostop</span><span class="o">=</span><span class="n">idle_minutes_to_autostop</span><span class="p">,</span>
                <span class="n">retry_until_up</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">retry_until_up</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">sky</span><span class="o">.</span><span class="n">stream_and_get</span><span class="p">(</span><span class="n">start_request_id</span><span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Executing the task on the cluster: </span><span class="si">{</span><span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">exec_job_id</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span>
                <span class="n">task</span><span class="p">,</span>
                <span class="n">cluster_name</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span><span class="p">,</span>
                <span class="o">**</span><span class="n">exec_kwargs</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">assert</span> <span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="n">sky_job_get</span><span class="p">(</span>
                <span class="n">exec_job_id</span><span class="p">,</span> <span class="n">settings</span><span class="o">.</span><span class="n">stream_logs</span><span class="p">,</span> <span class="n">settings</span><span class="o">.</span><span class="n">cluster_name</span>
            <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pipeline run failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">raise</span>

    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># Unset the service connector AWS profile ENV variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare_environment_variable</span><span class="p">(</span><span class="nb">set</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>
<h7 id="zenml.integrations.skypilot.orchestrators.skypilot_base_vm_orchestrator-functions">Functions</h7>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h6 id="zenml.integrations.skypilot.orchestrators.skypilot_orchestrator_entrypoint" class="doc doc-heading">
            <code>skypilot_orchestrator_entrypoint</code>


</h6>

    <div class="doc doc-contents ">

        <p>Entrypoint of the Skypilot master/orchestrator VM.</p>










  <div class="doc doc-children">







<h7 id="zenml.integrations.skypilot.orchestrators.skypilot_orchestrator_entrypoint-classes">Classes</h7>
<h7 id="zenml.integrations.skypilot.orchestrators.skypilot_orchestrator_entrypoint-functions">Functions</h7>

<div class="doc doc-object doc-function">


<h8 id="zenml.integrations.skypilot.orchestrators.skypilot_orchestrator_entrypoint.main" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h8>


    <div class="doc doc-contents ">

        <p>Entrypoint of the Skypilot master/orchestrator VM.</p>
<p>This is the entrypoint of the Skypilot master/orchestrator VM. It is
responsible for provisioning the VM and running the pipeline steps in
separate VMs.</p>
<p>The VM is provisioned using the <code>sky</code> library. The pipeline steps are run
using the <code>sky</code> library as well.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the active stack's orchestrator is not an instance of
SkypilotBaseOrchestrator.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the active stack's container registry is None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="Exception">Exception</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the orchestration or one of the steps fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/orchestrators/skypilot_orchestrator_entrypoint.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Entrypoint of the Skypilot master/orchestrator VM.</span>

<span class="sd">    This is the entrypoint of the Skypilot master/orchestrator VM. It is</span>
<span class="sd">    responsible for provisioning the VM and running the pipeline steps in</span>
<span class="sd">    separate VMs.</span>

<span class="sd">    The VM is provisioned using the `sky` library. The pipeline steps are run</span>
<span class="sd">    using the `sky` library as well.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If the active stack&#39;s orchestrator is not an instance of</span>
<span class="sd">            SkypilotBaseOrchestrator.</span>
<span class="sd">        ValueError: If the active stack&#39;s container registry is None.</span>
<span class="sd">        Exception: If the orchestration or one of the steps fails.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Log to the container&#39;s stdout so it can be streamed by the client.</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Skypilot orchestrator VM started.&quot;</span><span class="p">)</span>

    <span class="c1"># Parse / extract args.</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parse_args</span><span class="p">()</span>
    <span class="n">orchestrator_run_id</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">()</span>

    <span class="n">run</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">snapshot</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">get_snapshot</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">snapshot_id</span><span class="p">)</span>

        <span class="n">pipeline_dag</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">step_name</span><span class="p">:</span> <span class="n">step</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">upstream_steps</span>
            <span class="k">for</span> <span class="n">step_name</span><span class="p">,</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">step_configurations</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="n">step_command</span> <span class="o">=</span> <span class="n">StepEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_command</span><span class="p">()</span>
        <span class="n">entrypoint_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">step_command</span><span class="p">)</span>

        <span class="n">active_stack</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_stack</span>

        <span class="n">orchestrator</span> <span class="o">=</span> <span class="n">active_stack</span><span class="o">.</span><span class="n">orchestrator</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">orchestrator</span><span class="p">,</span> <span class="n">SkypilotBaseOrchestrator</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;The active stack&#39;s orchestrator is not an instance of SkypilotBaseOrchestrator.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Set up credentials</span>
        <span class="n">orchestrator</span><span class="o">.</span><span class="n">setup_credentials</span><span class="p">()</span>

        <span class="c1"># Set the service connector AWS profile ENV variable</span>
        <span class="n">orchestrator</span><span class="o">.</span><span class="n">prepare_environment_variable</span><span class="p">(</span><span class="nb">set</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># get active container registry</span>
        <span class="n">container_registry</span> <span class="o">=</span> <span class="n">active_stack</span><span class="o">.</span><span class="n">container_registry</span>
        <span class="k">if</span> <span class="n">container_registry</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Container registry cannot be None.&quot;</span><span class="p">)</span>

        <span class="c1"># Prepare Docker setup</span>
        <span class="n">setup</span><span class="p">,</span> <span class="n">task_envs</span> <span class="o">=</span> <span class="n">prepare_docker_setup</span><span class="p">(</span>
            <span class="n">container_registry_uri</span><span class="o">=</span><span class="n">container_registry</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">uri</span><span class="p">,</span>
            <span class="n">credentials</span><span class="o">=</span><span class="n">container_registry</span><span class="o">.</span><span class="n">credentials</span><span class="p">,</span>
            <span class="n">use_sudo</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Entrypoint doesn&#39;t use sudo</span>
        <span class="p">)</span>

        <span class="n">unique_resource_configs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">step_name</span><span class="p">,</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">step_configurations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">settings</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                <span class="n">SkypilotBaseOrchestratorSettings</span><span class="p">,</span>
                <span class="n">orchestrator</span><span class="o">.</span><span class="n">get_settings</span><span class="p">(</span><span class="n">step</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="c1"># Handle both str and Dict[str, int] types for accelerators</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">accelerators</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">accelerators_hashable</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span>
                    <span class="n">settings</span><span class="o">.</span><span class="n">accelerators</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">accelerators</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">accelerators_hashable</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({(</span><span class="n">settings</span><span class="o">.</span><span class="n">accelerators</span><span class="p">,</span> <span class="mi">1</span><span class="p">)})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">accelerators_hashable</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">resource_config</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">settings</span><span class="o">.</span><span class="n">instance_type</span><span class="p">,</span>
                <span class="n">settings</span><span class="o">.</span><span class="n">cpus</span><span class="p">,</span>
                <span class="n">settings</span><span class="o">.</span><span class="n">memory</span><span class="p">,</span>
                <span class="n">settings</span><span class="o">.</span><span class="n">disk_size</span><span class="p">,</span>  <span class="c1"># Assuming disk_size is part of the settings</span>
                <span class="n">settings</span><span class="o">.</span><span class="n">disk_tier</span><span class="p">,</span>  <span class="c1"># Assuming disk_tier is part of the settings</span>
                <span class="n">settings</span><span class="o">.</span><span class="n">use_spot</span><span class="p">,</span>
                <span class="n">settings</span><span class="o">.</span><span class="n">job_recovery</span><span class="p">,</span>
                <span class="n">settings</span><span class="o">.</span><span class="n">region</span><span class="p">,</span>
                <span class="n">settings</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span>
                <span class="n">accelerators_hashable</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">cluster_name_parts</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">sanitize_cluster_name</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">part</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">resource_config</span>
                <span class="k">if</span> <span class="n">part</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="p">]</span>
            <span class="n">cluster_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;cluster-</span><span class="si">{</span><span class="n">orchestrator_run_id</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">cluster_name_parts</span>
            <span class="p">)</span>
            <span class="n">unique_resource_configs</span><span class="p">[</span><span class="n">step_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">cluster_name</span>

        <span class="n">run</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">list_pipeline_runs</span><span class="p">(</span>
            <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;asc:created&quot;</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">snapshot_id</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">snapshot_id</span><span class="p">,</span>
            <span class="n">status</span><span class="o">=</span><span class="n">ExecutionStatus</span><span class="o">.</span><span class="n">INITIALIZING</span><span class="p">,</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Fetching pipeline run: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">run</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

        <span class="n">shared_env</span><span class="p">,</span> <span class="n">secrets</span> <span class="o">=</span> <span class="n">get_config_environment_vars</span><span class="p">()</span>
        <span class="n">shared_env</span><span class="p">[</span><span class="n">ENV_ZENML_SKYPILOT_ORCHESTRATOR_RUN_ID</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">orchestrator_run_id</span>
        <span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">run_step_on_skypilot_vm</span><span class="p">(</span><span class="n">step_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Run a pipeline step in a separate Skypilot VM.</span>

<span class="sd">            Args:</span>
<span class="sd">                step_name: Name of the step.</span>

<span class="sd">            Raises:</span>
<span class="sd">                Exception: If the step execution fails.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running step `</span><span class="si">{</span><span class="n">step_name</span><span class="si">}</span><span class="s2">` on a VM...&quot;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">cluster_name</span> <span class="o">=</span> <span class="n">unique_resource_configs</span><span class="p">[</span><span class="n">step_name</span><span class="p">]</span>

                <span class="n">image</span> <span class="o">=</span> <span class="n">SkypilotBaseOrchestrator</span><span class="o">.</span><span class="n">get_image</span><span class="p">(</span>
                    <span class="n">snapshot</span><span class="o">=</span><span class="n">snapshot</span><span class="p">,</span> <span class="n">step_name</span><span class="o">=</span><span class="n">step_name</span>
                <span class="p">)</span>

                <span class="n">step_args</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">StepEntrypointConfiguration</span><span class="o">.</span><span class="n">get_entrypoint_arguments</span><span class="p">(</span>
                        <span class="n">step_name</span><span class="o">=</span><span class="n">step_name</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="o">=</span><span class="n">snapshot</span><span class="o">.</span><span class="n">id</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="n">arguments_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">step_args</span><span class="p">)</span>

                <span class="n">step</span> <span class="o">=</span> <span class="n">snapshot</span><span class="o">.</span><span class="n">step_configurations</span><span class="p">[</span><span class="n">step_name</span><span class="p">]</span>
                <span class="n">settings</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
                    <span class="n">SkypilotBaseOrchestratorSettings</span><span class="p">,</span>
                    <span class="n">orchestrator</span><span class="o">.</span><span class="n">get_settings</span><span class="p">(</span><span class="n">step</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="n">step_env</span> <span class="o">=</span> <span class="n">shared_env</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">step_env</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                    <span class="n">env_utils</span><span class="o">.</span><span class="n">get_step_environment</span><span class="p">(</span>
                        <span class="n">step_config</span><span class="o">=</span><span class="n">step</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="n">stack</span><span class="o">=</span><span class="n">active_stack</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="c1"># For now, we don&#39;t support separating secrets from environment</span>
                <span class="n">step_env</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">secrets</span><span class="p">)</span>

                <span class="c1"># Create the Docker run command</span>
                <span class="n">run_command</span> <span class="o">=</span> <span class="n">create_docker_run_command</span><span class="p">(</span>
                    <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
                    <span class="n">entrypoint_str</span><span class="o">=</span><span class="n">entrypoint_str</span><span class="p">,</span>
                    <span class="n">arguments_str</span><span class="o">=</span><span class="n">arguments_str</span><span class="p">,</span>
                    <span class="n">environment</span><span class="o">=</span><span class="n">step_env</span><span class="p">,</span>
                    <span class="n">docker_run_args</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">docker_run_args</span><span class="p">,</span>
                    <span class="n">use_sudo</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Entrypoint doesn&#39;t use sudo</span>
                <span class="p">)</span>

                <span class="n">task_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">snapshot</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">step_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>

                <span class="c1"># Create task kwargs</span>
                <span class="n">task_kwargs</span> <span class="o">=</span> <span class="n">prepare_task_kwargs</span><span class="p">(</span>
                    <span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
                    <span class="n">run_command</span><span class="o">=</span><span class="n">run_command</span><span class="p">,</span>
                    <span class="n">setup</span><span class="o">=</span><span class="n">setup</span><span class="p">,</span>
                    <span class="n">task_envs</span><span class="o">=</span><span class="n">task_envs</span><span class="p">,</span>
                    <span class="n">task_name</span><span class="o">=</span><span class="n">task_name</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="n">task</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">Task</span><span class="p">(</span><span class="o">**</span><span class="n">task_kwargs</span><span class="p">)</span>

                <span class="c1"># Set resources</span>
                <span class="n">resources_kwargs</span> <span class="o">=</span> <span class="n">prepare_resources_kwargs</span><span class="p">(</span>
                    <span class="n">cloud</span><span class="o">=</span><span class="n">orchestrator</span><span class="o">.</span><span class="n">cloud</span><span class="p">,</span>
                    <span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
                    <span class="n">default_instance_type</span><span class="o">=</span><span class="n">orchestrator</span><span class="o">.</span><span class="n">DEFAULT_INSTANCE_TYPE</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="n">task</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">set_resources</span><span class="p">(</span><span class="n">sky</span><span class="o">.</span><span class="n">Resources</span><span class="p">(</span><span class="o">**</span><span class="n">resources_kwargs</span><span class="p">))</span>

                <span class="c1"># Prepare launch parameters</span>
                <span class="n">launch_kwargs</span> <span class="o">=</span> <span class="n">prepare_launch_kwargs</span><span class="p">(</span>
                    <span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="c1"># sky.launch now returns a request ID (async). Capture it so we can</span>
                <span class="c1"># optionally stream logs and block until completion when desired.</span>
                <span class="n">launch_request_id</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">launch</span><span class="p">(</span>
                    <span class="n">task</span><span class="p">,</span>
                    <span class="n">cluster_name</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">launch_kwargs</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">sky_job_get</span><span class="p">(</span><span class="n">launch_request_id</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">cluster_name</span><span class="p">)</span>

                <span class="c1"># Pop the resource configuration for this step</span>
                <span class="n">unique_resource_configs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">step_name</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">cluster_name</span> <span class="ow">in</span> <span class="n">unique_resource_configs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="c1"># If there are more steps using this configuration, skip deprovisioning the cluster</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Resource configuration for cluster &#39;</span><span class="si">{</span><span class="n">cluster_name</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                        <span class="s2">&quot;is used by subsequent steps. Skipping the deprovisioning of &quot;</span>
                        <span class="s2">&quot;the cluster.&quot;</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># If there are no more steps using this configuration, down the cluster</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Resource configuration for cluster &#39;</span><span class="si">{</span><span class="n">cluster_name</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                        <span class="s2">&quot;is not used by subsequent steps. deprovisioning the cluster.&quot;</span>
                    <span class="p">)</span>
                    <span class="n">down_request_id</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">down</span><span class="p">(</span><span class="n">cluster_name</span><span class="p">)</span>
                    <span class="c1"># Wait for the cluster to be terminated</span>
                    <span class="n">sky</span><span class="o">.</span><span class="n">stream_and_get</span><span class="p">(</span><span class="n">down_request_id</span><span class="p">)</span>

                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Running step `</span><span class="si">{</span><span class="n">step_name</span><span class="si">}</span><span class="s2">` on a VM is completed.&quot;</span>
                <span class="p">)</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed while launching step `</span><span class="si">{</span><span class="n">step_name</span><span class="si">}</span><span class="s2">`: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">raise</span>

        <span class="n">dag_runner</span> <span class="o">=</span> <span class="n">ThreadedDagRunner</span><span class="p">(</span>
            <span class="n">dag</span><span class="o">=</span><span class="n">pipeline_dag</span><span class="p">,</span> <span class="n">run_fn</span><span class="o">=</span><span class="n">run_step_on_skypilot_vm</span>
        <span class="p">)</span>
        <span class="n">dag_runner</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="n">failed_nodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">dag_runner</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dag_runner</span><span class="o">.</span><span class="n">node_states</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">==</span> <span class="n">NodeStatus</span><span class="o">.</span><span class="n">FAILED</span><span class="p">:</span>
                <span class="n">failed_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">failed_nodes</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;One or more steps failed: </span><span class="si">{</span><span class="n">failed_nodes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Orchestrator failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Try to mark the pipeline run as failed</span>
        <span class="k">if</span> <span class="n">run</span><span class="p">:</span>
            <span class="n">publish_failed_pipeline_run</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Marked pipeline run as failed in ZenML.&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h8 id="zenml.integrations.skypilot.orchestrators.skypilot_orchestrator_entrypoint.parse_args" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_args</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">Namespace</span></code>

</h8>


    <div class="doc doc-contents ">

        <p>Parse entrypoint arguments.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="argparse.Namespace">Namespace</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parsed args.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/orchestrators/skypilot_orchestrator_entrypoint.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parse_args</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">Namespace</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse entrypoint arguments.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Parsed args.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--run_name&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--snapshot_id&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>
<h7 id="zenml.integrations.skypilot.orchestrators.skypilot_orchestrator_entrypoint-modules">Modules</h7>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h6 id="zenml.integrations.skypilot.orchestrators.skypilot_orchestrator_entrypoint_configuration" class="doc doc-heading">
            <code>skypilot_orchestrator_entrypoint_configuration</code>


</h6>

    <div class="doc doc-contents ">

        <p>Entrypoint configuration for the Skypilot master/orchestrator VM.</p>










  <div class="doc doc-children">







<h7 id="zenml.integrations.skypilot.orchestrators.skypilot_orchestrator_entrypoint_configuration-classes">Classes</h7>

<div class="doc doc-object doc-class">



<h8 id="zenml.integrations.skypilot.orchestrators.skypilot_orchestrator_entrypoint_configuration.SkypilotOrchestratorEntrypointConfiguration" class="doc doc-heading">
            <code>SkypilotOrchestratorEntrypointConfiguration</code>


</h8>


    <div class="doc doc-contents ">


        <p>Entrypoint configuration for the Skypilot master/orchestrator VM.</p>











  <div class="doc doc-children">








<h9 id="zenml.integrations.skypilot.orchestrators.skypilot_orchestrator_entrypoint_configuration.SkypilotOrchestratorEntrypointConfiguration-functions">Functions</h9>

<div class="doc doc-object doc-function">


<h10 id="zenml.integrations.skypilot.orchestrators.skypilot_orchestrator_entrypoint_configuration.SkypilotOrchestratorEntrypointConfiguration.get_entrypoint_arguments" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_entrypoint_arguments</span><span class="p">(</span><span class="n">run_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">snapshot_id</span><span class="p">:</span> <span class="n">UUID</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h10>


    <div class="doc doc-contents ">

        <p>Gets all arguments that the entrypoint command should be called with.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>run_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the ZenML run.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>snapshot_id</code>
            </td>
            <td>
                  <code><span title="uuid.UUID">UUID</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID of the snapshot.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of entrypoint arguments.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/orchestrators/skypilot_orchestrator_entrypoint_configuration.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_entrypoint_arguments</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">run_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">snapshot_id</span><span class="p">:</span> <span class="s2">&quot;UUID&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets all arguments that the entrypoint command should be called with.</span>

<span class="sd">    Args:</span>
<span class="sd">        run_name: Name of the ZenML run.</span>
<span class="sd">        snapshot_id: ID of the snapshot.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of entrypoint arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;--</span><span class="si">{</span><span class="n">RUN_NAME_OPTION</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">run_name</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;--</span><span class="si">{</span><span class="n">SNAPSHOT_ID_OPTION</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">snapshot_id</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="n">args</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h10 id="zenml.integrations.skypilot.orchestrators.skypilot_orchestrator_entrypoint_configuration.SkypilotOrchestratorEntrypointConfiguration.get_entrypoint_command" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_entrypoint_command</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h10>


    <div class="doc doc-contents ">

        <p>Returns a command that runs the entrypoint module.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Entrypoint command.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/orchestrators/skypilot_orchestrator_entrypoint_configuration.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_entrypoint_command</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a command that runs the entrypoint module.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Entrypoint command.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">command</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;python&quot;</span><span class="p">,</span>
        <span class="s2">&quot;-m&quot;</span><span class="p">,</span>
        <span class="s2">&quot;zenml.integrations.skypilot.orchestrators.skypilot_orchestrator_entrypoint&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">command</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h10 id="zenml.integrations.skypilot.orchestrators.skypilot_orchestrator_entrypoint_configuration.SkypilotOrchestratorEntrypointConfiguration.get_entrypoint_options" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_entrypoint_options</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h10>


    <div class="doc doc-contents ">

        <p>Gets all the options required for running this entrypoint.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Set">Set</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Entrypoint options.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/orchestrators/skypilot_orchestrator_entrypoint_configuration.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_entrypoint_options</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets all the options required for running this entrypoint.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Entrypoint options.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">RUN_NAME_OPTION</span><span class="p">,</span>
        <span class="n">SNAPSHOT_ID_OPTION</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">options</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="zenml.integrations.skypilot.utils" class="doc doc-heading">
            <code>utils</code>


</h4>

    <div class="doc doc-contents ">

        <p>Utility functions for Skypilot orchestrators.</p>










  <div class="doc doc-children">







<h5 id="zenml.integrations.skypilot.utils-classes">Classes</h5>
<h5 id="zenml.integrations.skypilot.utils-functions">Functions</h5>

<div class="doc doc-object doc-function">


<h6 id="zenml.integrations.skypilot.utils.create_docker_run_command" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_docker_run_command</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">entrypoint_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arguments_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">environment</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">docker_run_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">use_sudo</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h6>


    <div class="doc doc-contents ">

        <p>Create a Docker run command string.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>image</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Docker image to run.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>entrypoint_str</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Entrypoint command.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>arguments_str</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Command arguments.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>environment</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Environment variables.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>docker_run_args</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional Docker run arguments.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_sudo</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use sudo prefix in docker commands.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Docker run command as string.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_docker_run_command</span><span class="p">(</span>
    <span class="n">image</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">entrypoint_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">arguments_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">environment</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">docker_run_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">use_sudo</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a Docker run command string.</span>

<span class="sd">    Args:</span>
<span class="sd">        image: Docker image to run.</span>
<span class="sd">        entrypoint_str: Entrypoint command.</span>
<span class="sd">        arguments_str: Command arguments.</span>
<span class="sd">        environment: Environment variables.</span>
<span class="sd">        docker_run_args: Additional Docker run arguments.</span>
<span class="sd">        use_sudo: Whether to use sudo prefix in docker commands.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Docker run command as string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">docker_environment_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;-e </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">environment</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">custom_run_args</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">docker_run_args</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">custom_run_args</span><span class="p">:</span>
        <span class="n">custom_run_args</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span>

    <span class="n">sudo_prefix</span> <span class="o">=</span> <span class="s2">&quot;sudo &quot;</span> <span class="k">if</span> <span class="n">use_sudo</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sudo_prefix</span><span class="si">}</span><span class="s2">docker run --rm </span><span class="si">{</span><span class="n">custom_run_args</span><span class="si">}{</span><span class="n">docker_environment_str</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">image</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">entrypoint_str</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">arguments_str</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="zenml.integrations.skypilot.utils.prepare_docker_setup" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepare_docker_setup</span><span class="p">(</span><span class="n">container_registry_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">credentials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">use_sudo</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span></code>

</h6>


    <div class="doc doc-contents ">

        <p>Prepare Docker login setup command and environment variables.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>container_registry_uri</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>URI of the container registry.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>credentials</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional credentials (username, password) tuple.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_sudo</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use sudo prefix in docker commands.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="typing.Optional">Optional</span>[<span title="str">str</span>], <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of (setup command, environment variables)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prepare_docker_setup</span><span class="p">(</span>
    <span class="n">container_registry_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">credentials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_sudo</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare Docker login setup command and environment variables.</span>

<span class="sd">    Args:</span>
<span class="sd">        container_registry_uri: URI of the container registry.</span>
<span class="sd">        credentials: Optional credentials (username, password) tuple.</span>
<span class="sd">        use_sudo: Whether to use sudo prefix in docker commands.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (setup command, environment variables)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">credentials</span><span class="p">:</span>
        <span class="n">docker_username</span><span class="p">,</span> <span class="n">docker_password</span> <span class="o">=</span> <span class="n">credentials</span>
        <span class="n">sudo_prefix</span> <span class="o">=</span> <span class="s2">&quot;sudo &quot;</span> <span class="k">if</span> <span class="n">use_sudo</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="n">setup</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sudo_prefix</span><span class="si">}</span><span class="s2">docker login --username $DOCKER_USERNAME --password &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;$DOCKER_PASSWORD </span><span class="si">{</span><span class="n">container_registry_uri</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">task_envs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;DOCKER_USERNAME&quot;</span><span class="p">:</span> <span class="n">docker_username</span><span class="p">,</span>
            <span class="s2">&quot;DOCKER_PASSWORD&quot;</span><span class="p">:</span> <span class="n">docker_password</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">setup</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">task_envs</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">return</span> <span class="n">setup</span><span class="p">,</span> <span class="n">task_envs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="zenml.integrations.skypilot.utils.prepare_launch_kwargs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepare_launch_kwargs</span><span class="p">(</span><span class="n">settings</span><span class="p">:</span> <span class="n">SkypilotBaseOrchestratorSettings</span><span class="p">,</span> <span class="n">down</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">idle_minutes_to_autostop</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></code>

</h6>


    <div class="doc doc-contents ">

        <p>Prepare launch keyword arguments for sky.launch.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>settings</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SkypilotBaseOrchestratorSettings(warn_about_plain_text_secrets: bool = False, **kwargs: Any) (zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings)" href="#zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings">SkypilotBaseOrchestratorSettings</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Skypilot orchestrator settings.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>down</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="bool">bool</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to tear down the cluster after job completion.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>idle_minutes_to_autostop</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minutes to autostop after idleness.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Launch keyword arguments dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prepare_launch_kwargs</span><span class="p">(</span>
    <span class="n">settings</span><span class="p">:</span> <span class="n">SkypilotBaseOrchestratorSettings</span><span class="p">,</span>
    <span class="n">down</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">idle_minutes_to_autostop</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare launch keyword arguments for sky.launch.</span>

<span class="sd">    Args:</span>
<span class="sd">        settings: Skypilot orchestrator settings.</span>
<span class="sd">        down: Whether to tear down the cluster after job completion.</span>
<span class="sd">        idle_minutes_to_autostop: Minutes to autostop after idleness.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Launch keyword arguments dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Determine values falling back to settings where applicable</span>
    <span class="n">down_value</span> <span class="o">=</span> <span class="n">down</span> <span class="k">if</span> <span class="n">down</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">settings</span><span class="o">.</span><span class="n">down</span>
    <span class="n">idle_value</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">idle_minutes_to_autostop</span>
        <span class="k">if</span> <span class="n">idle_minutes_to_autostop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="n">settings</span><span class="o">.</span><span class="n">idle_minutes_to_autostop</span>
    <span class="p">)</span>

    <span class="c1"># The following parameters were removed from sky.launch in versions &gt; 0.8.</span>
    <span class="c1"># We therefore no longer include them in the kwargs passed to the call.</span>
    <span class="c1"># • stream_logs – handled by explicitly calling sky.stream_and_get</span>
    <span class="c1"># • detach_setup / detach_run – setup/run are now detached by default</span>

    <span class="n">launch_kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;retry_until_up&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">retry_until_up</span><span class="p">,</span>
        <span class="s2">&quot;idle_minutes_to_autostop&quot;</span><span class="p">:</span> <span class="n">idle_value</span><span class="p">,</span>
        <span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="n">down_value</span><span class="p">,</span>
        <span class="s2">&quot;backend&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">settings</span><span class="o">.</span><span class="n">launch_settings</span><span class="p">,</span>  <span class="c1"># Keep user-provided extras</span>
    <span class="p">}</span>

    <span class="c1"># Remove keys that are no longer supported by sky.launch.</span>
    <span class="k">for</span> <span class="n">_deprecated</span> <span class="ow">in</span> <span class="p">(</span>
        <span class="s2">&quot;stream_logs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;detach_setup&quot;</span><span class="p">,</span>
        <span class="s2">&quot;detach_run&quot;</span><span class="p">,</span>
        <span class="s2">&quot;num_nodes&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">launch_kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">_deprecated</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Remove None values to avoid overriding SkyPilot defaults</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">launch_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="zenml.integrations.skypilot.utils.prepare_resources_kwargs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepare_resources_kwargs</span><span class="p">(</span><span class="n">cloud</span><span class="p">:</span> <span class="n">Cloud</span><span class="p">,</span> <span class="n">settings</span><span class="p">:</span> <span class="n">SkypilotBaseOrchestratorSettings</span><span class="p">,</span> <span class="n">default_instance_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">kubernetes_image</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></code>

</h6>


    <div class="doc doc-contents ">

        <p>Prepare resources keyword arguments for sky.Resources.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cloud</code>
            </td>
            <td>
                  <code><span title="sky.clouds.cloud.Cloud">Cloud</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Skypilot cloud.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>settings</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SkypilotBaseOrchestratorSettings(warn_about_plain_text_secrets: bool = False, **kwargs: Any) (zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings)" href="#zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings">SkypilotBaseOrchestratorSettings</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Skypilot orchestrator settings.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_instance_type</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Default instance type.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kubernetes_image</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Image to use for Kubernetes (if applicable).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resources keyword arguments dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prepare_resources_kwargs</span><span class="p">(</span>
    <span class="n">cloud</span><span class="p">:</span> <span class="s2">&quot;Cloud&quot;</span><span class="p">,</span>
    <span class="n">settings</span><span class="p">:</span> <span class="n">SkypilotBaseOrchestratorSettings</span><span class="p">,</span>
    <span class="n">default_instance_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">kubernetes_image</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare resources keyword arguments for sky.Resources.</span>

<span class="sd">    Args:</span>
<span class="sd">        cloud: Skypilot cloud.</span>
<span class="sd">        settings: Skypilot orchestrator settings.</span>
<span class="sd">        default_instance_type: Default instance type.</span>
<span class="sd">        kubernetes_image: Image to use for Kubernetes (if applicable).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Resources keyword arguments dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">resources_kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;cloud&quot;</span><span class="p">:</span> <span class="n">cloud</span><span class="p">,</span>
        <span class="s2">&quot;instance_type&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">instance_type</span> <span class="ow">or</span> <span class="n">default_instance_type</span><span class="p">,</span>
        <span class="s2">&quot;cpus&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">cpus</span><span class="p">,</span>
        <span class="s2">&quot;memory&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">memory</span><span class="p">,</span>
        <span class="s2">&quot;accelerators&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">accelerators</span><span class="p">,</span>
        <span class="s2">&quot;accelerator_args&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">accelerator_args</span><span class="p">,</span>
        <span class="s2">&quot;use_spot&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">use_spot</span><span class="p">,</span>
        <span class="s2">&quot;job_recovery&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">job_recovery</span><span class="p">,</span>
        <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">region</span><span class="p">,</span>
        <span class="s2">&quot;zone&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span>
        <span class="s2">&quot;image_id&quot;</span><span class="p">:</span> <span class="n">kubernetes_image</span>
        <span class="k">if</span> <span class="n">kubernetes_image</span>
        <span class="k">else</span> <span class="n">settings</span><span class="o">.</span><span class="n">image_id</span><span class="p">,</span>
        <span class="s2">&quot;disk_size&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">disk_size</span><span class="p">,</span>
        <span class="s2">&quot;disk_tier&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">disk_tier</span><span class="p">,</span>
        <span class="s2">&quot;ports&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">ports</span><span class="p">,</span>
        <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
        <span class="s2">&quot;any_of&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">any_of</span><span class="p">,</span>
        <span class="s2">&quot;ordered&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">ordered</span><span class="p">,</span>
        <span class="o">**</span><span class="n">settings</span><span class="o">.</span><span class="n">resources_settings</span><span class="p">,</span>  <span class="c1"># Add any arbitrary resource settings</span>
    <span class="p">}</span>

    <span class="c1"># Remove None values to avoid overriding SkyPilot defaults</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">resources_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="zenml.integrations.skypilot.utils.prepare_task_kwargs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepare_task_kwargs</span><span class="p">(</span><span class="n">settings</span><span class="p">:</span> <span class="n">SkypilotBaseOrchestratorSettings</span><span class="p">,</span> <span class="n">run_command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">setup</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">task_envs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">task_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></code>

</h6>


    <div class="doc doc-contents ">

        <p>Prepare task keyword arguments for sky.Task.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>settings</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SkypilotBaseOrchestratorSettings(warn_about_plain_text_secrets: bool = False, **kwargs: Any) (zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings)" href="#zenml.integrations.skypilot.flavors.skypilot_orchestrator_base_vm_config.SkypilotBaseOrchestratorSettings">SkypilotBaseOrchestratorSettings</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Skypilot orchestrator settings.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_command</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Command to run.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>setup</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Setup command.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>task_envs</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Task environment variables.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>task_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Task name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Task keyword arguments dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prepare_task_kwargs</span><span class="p">(</span>
    <span class="n">settings</span><span class="p">:</span> <span class="n">SkypilotBaseOrchestratorSettings</span><span class="p">,</span>
    <span class="n">run_command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">setup</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">task_envs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">task_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare task keyword arguments for sky.Task.</span>

<span class="sd">    Args:</span>
<span class="sd">        settings: Skypilot orchestrator settings.</span>
<span class="sd">        run_command: Command to run.</span>
<span class="sd">        setup: Setup command.</span>
<span class="sd">        task_envs: Task environment variables.</span>
<span class="sd">        task_name: Task name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Task keyword arguments dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Merge envs from settings with existing task_envs</span>
    <span class="n">merged_envs</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># First add user-provided envs</span>
    <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">envs</span><span class="p">:</span>
        <span class="n">merged_envs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">envs</span><span class="p">)</span>

    <span class="c1"># Then add task_envs which take precedence</span>
    <span class="k">if</span> <span class="n">task_envs</span><span class="p">:</span>
        <span class="n">merged_envs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">task_envs</span><span class="p">)</span>

    <span class="n">task_kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;run&quot;</span><span class="p">:</span> <span class="n">run_command</span><span class="p">,</span>
        <span class="s2">&quot;setup&quot;</span><span class="p">:</span> <span class="n">setup</span><span class="p">,</span>
        <span class="s2">&quot;envs&quot;</span><span class="p">:</span> <span class="n">merged_envs</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">task_name</span> <span class="ow">or</span> <span class="n">task_name</span><span class="p">,</span>
        <span class="s2">&quot;workdir&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span>
        <span class="s2">&quot;file_mounts_mapping&quot;</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">file_mounts</span><span class="p">,</span>
        <span class="o">**</span><span class="n">settings</span><span class="o">.</span><span class="n">task_settings</span><span class="p">,</span>  <span class="c1"># Add any arbitrary task settings</span>
    <span class="p">}</span>

    <span class="c1"># Remove None values to avoid overriding SkyPilot defaults</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">task_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="zenml.integrations.skypilot.utils.sanitize_cluster_name" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sanitize_cluster_name</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h6>


    <div class="doc doc-contents ">

        <p>Sanitize the value to be used in a cluster name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Arbitrary input cluster name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sanitized cluster name.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sanitize_cluster_name</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sanitize the value to be used in a cluster name.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: Arbitrary input cluster name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Sanitized cluster name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;[^a-z0-9-]&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="p">)</span>  <span class="c1"># replaces any character that is not a lowercase letter, digit, or hyphen with a hyphen</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^[-]+&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>  <span class="c1"># trim leading hyphens</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[-]+$&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>  <span class="c1"># trim trailing hyphens</span>
    <span class="k">return</span> <span class="n">name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="zenml.integrations.skypilot.utils.sky_job_get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sky_job_get</span><span class="p">(</span><span class="n">request_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stream_logs</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">cluster_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SubmissionResult</span><span class="p">]</span></code>

</h6>


    <div class="doc doc-contents ">

        <p>Handle SkyPilot request results based on stream_logs setting.</p>
<p>SkyPilot API exec and launch methods are asynchronous and return a request ID.
This method waits for the operation to complete and returns the result.
If stream_logs is True, it will also stream the logs and wait for the
job to complete.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>request_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The request ID returned from a SkyPilot operation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>stream_logs</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to stream logs while waiting for completion.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cluster_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the cluster to tail logs for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="SubmissionResult(wait_for_completion: Optional[Callable[[], None]] = None, metadata: Optional[Dict[str, MetadataType]] = None) (zenml.orchestrators.SubmissionResult)" href="../core_code_docs/core-orchestrators.html#zenml.orchestrators.SubmissionResult">SubmissionResult</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional submission result.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zenml/integrations/skypilot/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sky_job_get</span><span class="p">(</span>
    <span class="n">request_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stream_logs</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">cluster_name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SubmissionResult</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handle SkyPilot request results based on stream_logs setting.</span>

<span class="sd">    SkyPilot API exec and launch methods are asynchronous and return a request ID.</span>
<span class="sd">    This method waits for the operation to complete and returns the result.</span>
<span class="sd">    If stream_logs is True, it will also stream the logs and wait for the</span>
<span class="sd">    job to complete.</span>

<span class="sd">    Args:</span>
<span class="sd">        request_id: The request ID returned from a SkyPilot operation.</span>
<span class="sd">        stream_logs: Whether to stream logs while waiting for completion.</span>
<span class="sd">        cluster_name: The name of the cluster to tail logs for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional submission result.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">stream_logs</span><span class="p">:</span>
        <span class="c1"># Stream logs and wait for completion</span>
        <span class="n">job_id</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">stream_and_get</span><span class="p">(</span><span class="n">request_id</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Just wait for completion without streaming logs</span>
        <span class="n">job_id</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">request_id</span><span class="p">)</span>

    <span class="n">_wait_for_completion</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">stream_logs</span><span class="p">:</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_wait_for_completion</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># 0=Successful, 100=Failed</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">sky</span><span class="o">.</span><span class="n">tail_logs</span><span class="p">(</span>
                <span class="n">cluster_name</span><span class="o">=</span><span class="n">cluster_name</span><span class="p">,</span> <span class="n">job_id</span><span class="o">=</span><span class="n">job_id</span><span class="p">,</span> <span class="n">follow</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">status</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;SkyPilot job </span><span class="si">{</span><span class="n">job_id</span><span class="si">}</span><span class="s2"> failed with status </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

    <span class="k">return</span> <span class="n">SubmissionResult</span><span class="p">(</span><span class="n">wait_for_completion</span><span class="o">=</span><span class="n">_wait_for_completion</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 ZenML GmbH – <a href="#__consent">Change cookie settings</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  
    
  




<h4>This website uses cookies</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
      <button type="reset" class="md-button md-button--primary">Reject</button>
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>